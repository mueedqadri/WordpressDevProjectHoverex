{"version":3,"sources":["webpack://wp/webpack/bootstrap","webpack://wp/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://wp/@wordpress/dom/src/dom.js","webpack://wp/@wordpress/dom/src/focusable.js","webpack://wp/@wordpress/dom/src/index.js","webpack://wp/@wordpress/dom/src/phrasing-content.js","webpack://wp/@wordpress/dom/src/tabbable.js","webpack://wp/external {\"this\":\"lodash\"}"],"names":["getComputedStyle","node","ownerDocument","defaultView","isSelectionForward","selection","anchorNode","focusNode","anchorOffset","focusOffset","position","compareDocumentPosition","DOCUMENT_POSITION_PRECEDING","DOCUMENT_POSITION_FOLLOWING","isEdge","container","isReverse","onlyVertical","includes","tagName","selectionStart","selectionEnd","value","length","isContentEditable","getSelection","rangeCount","originalRange","getRangeAt","range","cloneRange","isForward","isCollapsed","collapse","rangeRect","getRectangleFromRange","computedStyle","lineHeight","parseInt","height","padding","buffer","containerRect","getBoundingClientRect","originalRangeRect","verticalEdge","top","bottom","direction","isReverseDir","x","left","right","y","testRange","hiddenCaretRangeFromPoint","side","testRect","Math","abs","isHorizontalEdge","isVerticalEdge","collapsed","startContainer","nodeName","parentNode","index","Array","from","childNodes","indexOf","createRange","setStart","setEnd","rect","getClientRects","padNode","createTextNode","insertNode","removeChild","computeCaretRect","win","placeCaretAtHorizontalEdge","focus","rangeTarget","selectNodeContents","removeAllRanges","addRange","caretRangeFromPoint","doc","caretPositionFromPoint","point","offsetNode","offset","originalZIndex","style","zIndex","originalPosition","placeCaretAtVerticalEdge","mayUseScroll","editableRect","contains","scrollIntoView","isTextField","element","contentEditable","nonTextInputs","type","isNumberInput","valueAsNumber","documentHasTextSelection","inputFieldHasUncollapsedSelection","error","documentHasUncollapsedSelection","activeElement","documentHasSelection","isEntirelySelected","endContainer","startOffset","endOffset","lastChild","lastChildContentLength","nodeType","TEXT_NODE","data","firstChild","getScrollContainer","scrollHeight","clientHeight","overflowY","test","getOffsetParent","closestElement","ELEMENT_NODE","offsetParent","replace","processedNode","newNode","insertAfter","remove","referenceNode","insertBefore","nextSibling","unwrap","parent","replaceTag","createElement","appendChild","replaceChild","wrap","__unstableStripHTML","html","document","window","DOMParser","parseFromString","body","textContent","cleanNodeList","nodeList","schema","inline","forEach","tag","toLowerCase","hasOwnProperty","isMatch","attributes","classes","children","require","allowEmpty","isEmpty","hasAttributes","name","removeAttribute","classList","mattchers","map","item","className","RegExp","noop","some","hasChildNodes","querySelector","join","isPhrasingContent","child","nextElementSibling","every","nodeValue","trim","removeInvalidHTML","HTML","implementation","createHTMLDocument","innerHTML","SELECTOR","isVisible","offsetWidth","offsetHeight","skipFocus","getAttribute","isValidFocusableArea","closest","img","find","context","elements","querySelectorAll","filter","focusable","tabbable","textContentSchema","strong","em","s","del","ins","a","code","abbr","sub","sup","br","small","q","dfn","time","var","samp","kbd","i","b","u","mark","ruby","rt","rp","bdi","bdo","wbr","without","Object","keys","omit","embeddedContentSchema","audio","canvas","embed","object","video","phrasingContentSchema","getPhrasingContentSchema","isTextContent","getTabIndex","tabIndex","isTabbableIndex","createStatefulCollapseRadioGroup","CHOSEN_RADIO_BY_NAME","collapseRadioGroup","result","checked","concat","hasChosen","isChosen","hadChosenElement","mapElementToObjectTabbable","mapObjectTabbableToElement","compareObjectTabbables","aTabIndex","bTabIndex","filterTabbable","focusables","sort","reduce","findFocusable","findPrevious","last","findNext","remaining","slice","first"],"mappings":";;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AAAA;AAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;AACA,C;;;;;;;;;;;;ACbA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAGA;AAEA;;;;AAGA;;AAEA,SAASA,gBAAT,CAA2BC,IAA3B,EAAkC;AACjC,SAAOA,IAAI,CAACC,aAAL,CAAmBC,WAAnB,CAA+BH,gBAA/B,CAAiDC,IAAjD,CAAP;AACA;AAED;;;;;;;;;;;;AAUA,SAASG,kBAAT,CAA6BC,SAA7B,EAAyC;AAAA,MAChCC,UADgC,GACqBD,SADrB,CAChCC,UADgC;AAAA,MACpBC,SADoB,GACqBF,SADrB,CACpBE,SADoB;AAAA,MACTC,YADS,GACqBH,SADrB,CACTG,YADS;AAAA,MACKC,WADL,GACqBJ,SADrB,CACKI,WADL;AAGxC,MAAMC,QAAQ,GAAGJ,UAAU,CAACK,uBAAX,CAAoCJ,SAApC,CAAjB,CAHwC,CAKxC;AACA;;AACA;AACA;AACA;;AACA,MAAKG,QAAQ,GAAGJ,UAAU,CAACM,2BAA3B,EAAyD;AACxD,WAAO,KAAP;AACA;;AAED,MAAKF,QAAQ,GAAGJ,UAAU,CAACO,2BAA3B,EAAyD;AACxD,WAAO,IAAP;AACA;AACD;AAEA;AACA;;;AACA,MAAKH,QAAQ,KAAK,CAAlB,EAAsB;AACrB,WAAOF,YAAY,IAAIC,WAAvB;AACA,GAvBuC,CAyBxC;;;AACA,SAAO,IAAP;AACA;AAED;;;;;;;;;;;;;AAWA,SAASK,MAAT,CAAiBC,SAAjB,EAA4BC,SAA5B,EAAuCC,YAAvC,EAAsD;AACrD,MAAKC,uDAAQ,CAAE,CAAE,OAAF,EAAW,UAAX,CAAF,EAA2BH,SAAS,CAACI,OAArC,CAAb,EAA8D;AAC7D,QAAKJ,SAAS,CAACK,cAAV,KAA6BL,SAAS,CAACM,YAA5C,EAA2D;AAC1D,aAAO,KAAP;AACA;;AAED,QAAKL,SAAL,EAAiB;AAChB,aAAOD,SAAS,CAACK,cAAV,KAA6B,CAApC;AACA;;AAED,WAAOL,SAAS,CAACO,KAAV,CAAgBC,MAAhB,KAA2BR,SAAS,CAACK,cAA5C;AACA;;AAED,MAAK,CAAEL,SAAS,CAACS,iBAAjB,EAAqC;AACpC,WAAO,IAAP;AACA;;AAfoD,MAiB7CtB,aAjB6C,GAiB3Ba,SAjB2B,CAiB7Cb,aAjB6C;AAAA,MAkB7CC,WAlB6C,GAkB7BD,aAlB6B,CAkB7CC,WAlB6C;AAoBrD,MAAME,SAAS,GAAGF,WAAW,CAACsB,YAAZ,EAAlB;;AAEA,MAAK,CAAEpB,SAAS,CAACqB,UAAjB,EAA8B;AAC7B,WAAO,KAAP;AACA;;AAED,MAAMC,aAAa,GAAGtB,SAAS,CAACuB,UAAV,CAAsB,CAAtB,CAAtB;AACA,MAAMC,KAAK,GAAGF,aAAa,CAACG,UAAd,EAAd;AACA,MAAMC,SAAS,GAAG3B,kBAAkB,CAAEC,SAAF,CAApC;AACA,MAAM2B,WAAW,GAAG3B,SAAS,CAAC2B,WAA9B,CA7BqD,CA+BrD;;AACA,MAAK,CAAEA,WAAP,EAAqB;AACpBH,SAAK,CAACI,QAAN,CAAgB,CAAEF,SAAlB;AACA;;AAED,MAAMG,SAAS,GAAGC,qBAAqB,CAAEN,KAAF,CAAvC;;AAEA,MAAK,CAAEK,SAAP,EAAmB;AAClB,WAAO,KAAP;AACA;;AAED,MAAME,aAAa,GAAGpC,gBAAgB,CAAEe,SAAF,CAAtC;AACA,MAAMsB,UAAU,GAAGC,QAAQ,CAAEF,aAAa,CAACC,UAAhB,EAA4B,EAA5B,CAAR,IAA4C,CAA/D,CA3CqD,CA6CrD;AACA;;AACA,MACC,CAAEL,WAAF,IACAE,SAAS,CAACK,MAAV,GAAmBF,UADnB,IAEAN,SAAS,KAAKf,SAHf,EAIE;AACD,WAAO,KAAP;AACA;;AAED,MAAMwB,OAAO,GACZF,QAAQ,CACPF,aAAa,kBAAapB,SAAS,GAAG,KAAH,GAAW,QAAjC,EADN,EAEP,EAFO,CAAR,IAGK,CAJN,CAvDqD,CA6DrD;AACA;AACA;AACA;;AACA,MAAMyB,MAAM,GAAK,IAAIH,QAAQ,CAAED,UAAF,EAAc,EAAd,CAAd,GAAqC,CAApD;AACA,MAAMK,aAAa,GAAG3B,SAAS,CAAC4B,qBAAV,EAAtB;AACA,MAAMC,iBAAiB,GAAGT,qBAAqB,CAAER,aAAF,CAA/C;AACA,MAAMkB,YAAY,GAAG7B,SAAS,GAC3B0B,aAAa,CAACI,GAAd,GAAoBN,OAApB,GAA8BI,iBAAiB,CAACE,GAAlB,GAAwBL,MAD3B,GAE3BC,aAAa,CAACK,MAAd,GAAuBP,OAAvB,GAAiCI,iBAAiB,CAACG,MAAlB,GAA2BN,MAF/D;;AAIA,MAAK,CAAEI,YAAP,EAAsB;AACrB,WAAO,KAAP;AACA;;AAED,MAAK5B,YAAL,EAAoB;AACnB,WAAO,IAAP;AACA,GA9EoD,CAgFrD;;;AAhFqD,MAiF7C+B,SAjF6C,GAiF/BZ,aAjF+B,CAiF7CY,SAjF6C;AAkFrD,MAAMC,YAAY,GAAGD,SAAS,KAAK,KAAd,GAAsB,CAAEhC,SAAxB,GAAoCA,SAAzD,CAlFqD,CAoFrD;AACA;AACA;AACA;AACA;;AACA,MAAMkC,CAAC,GAAGD,YAAY,GAAGP,aAAa,CAACS,IAAd,GAAqB,CAAxB,GAA4BT,aAAa,CAACU,KAAd,GAAsB,CAAxE;AACA,MAAMC,CAAC,GAAGrC,SAAS,GAChB0B,aAAa,CAACI,GAAd,GAAoBL,MADJ,GAEhBC,aAAa,CAACK,MAAd,GAAuBN,MAF1B;AAGA,MAAMa,SAAS,GAAGC,yBAAyB,CAC1CrD,aAD0C,EAE1CgD,CAF0C,EAG1CG,CAH0C,EAI1CtC,SAJ0C,CAA3C;;AAOA,MAAK,CAAEuC,SAAP,EAAmB;AAClB,WAAO,KAAP;AACA;;AAED,MAAME,IAAI,GAAGP,YAAY,GAAG,MAAH,GAAY,OAArC;AACA,MAAMQ,QAAQ,GAAGtB,qBAAqB,CAAEmB,SAAF,CAAtC,CAzGqD,CA2GrD;;AACA,SAAOI,IAAI,CAACC,GAAL,CAAUF,QAAQ,CAAED,IAAF,CAAR,GAAmBtB,SAAS,CAAEsB,IAAF,CAAtC,KAAoD,CAA3D;AACA;AAED;;;;;;;;;;AAQO,SAASI,gBAAT,CAA2B7C,SAA3B,EAAsCC,SAAtC,EAAkD;AACxD,SAAOF,MAAM,CAAEC,SAAF,EAAaC,SAAb,CAAb;AACA;AAED;;;;;;;;;AAQO,SAAS6C,cAAT,CAAyB9C,SAAzB,EAAoCC,SAApC,EAAgD;AACtD,SAAOF,MAAM,CAAEC,SAAF,EAAaC,SAAb,EAAwB,IAAxB,CAAb;AACA;AAED;;;;;;;;AAOO,SAASmB,qBAAT,CAAgCN,KAAhC,EAAwC;AAC9C;AACA;AACA;AACA,MAAK,CAAEA,KAAK,CAACiC,SAAb,EAAyB;AACxB,WAAOjC,KAAK,CAACc,qBAAN,EAAP;AACA;;AAN6C,eAQnBd,KARmB;AAAA,MAQtCkC,cARsC,UAQtCA,cARsC;AAAA,MAStC7D,aATsC,GASpB6D,cAToB,CAStC7D,aATsC,EAW9C;;AACA,MAAK6D,cAAc,CAACC,QAAf,KAA4B,IAAjC,EAAwC;AAAA,QAC/BC,UAD+B,GAChBF,cADgB,CAC/BE,UAD+B;AAEvC,QAAMC,KAAK,GAAGC,KAAK,CAACC,IAAN,CAAYH,UAAU,CAACI,UAAvB,EAAoCC,OAApC,CACbP,cADa,CAAd;AAIAlC,SAAK,GAAG3B,aAAa,CAACqE,WAAd,EAAR;AACA1C,SAAK,CAAC2C,QAAN,CAAgBP,UAAhB,EAA4BC,KAA5B;AACArC,SAAK,CAAC4C,MAAN,CAAcR,UAAd,EAA0BC,KAA1B;AACA;;AAED,MAAIQ,IAAI,GAAG7C,KAAK,CAAC8C,cAAN,GAAwB,CAAxB,CAAX,CAvB8C,CAyB9C;AACA;AACA;AACA;AACA;;AACA,MAAK,CAAED,IAAP,EAAc;AACb,QAAME,OAAO,GAAG1E,aAAa,CAAC2E,cAAd,CAA8B,QAA9B,CAAhB,CADa,CAEb;;AACAhD,SAAK,GAAGA,KAAK,CAACC,UAAN,EAAR;AACAD,SAAK,CAACiD,UAAN,CAAkBF,OAAlB;AACAF,QAAI,GAAG7C,KAAK,CAAC8C,cAAN,GAAwB,CAAxB,CAAP;AACAC,WAAO,CAACX,UAAR,CAAmBc,WAAnB,CAAgCH,OAAhC;AACA;;AAED,SAAOF,IAAP;AACA;AAED;;;;;;;;AAOO,SAASM,gBAAT,CAA2BC,GAA3B,EAAiC;AACvC,MAAM5E,SAAS,GAAG4E,GAAG,CAACxD,YAAJ,EAAlB;AACA,MAAMI,KAAK,GAAGxB,SAAS,CAACqB,UAAV,GAAuBrB,SAAS,CAACuB,UAAV,CAAsB,CAAtB,CAAvB,GAAmD,IAAjE;;AAEA,MAAK,CAAEC,KAAP,EAAe;AACd;AACA;;AAED,SAAOM,qBAAqB,CAAEN,KAAF,CAA5B;AACA;AAED;;;;;;;AAMO,SAASqD,0BAAT,CAAqCnE,SAArC,EAAgDC,SAAhD,EAA4D;AAClE,MAAK,CAAED,SAAP,EAAmB;AAClB;AACA;;AAED,MAAKG,uDAAQ,CAAE,CAAE,OAAF,EAAW,UAAX,CAAF,EAA2BH,SAAS,CAACI,OAArC,CAAb,EAA8D;AAC7DJ,aAAS,CAACoE,KAAV;;AACA,QAAKnE,SAAL,EAAiB;AAChBD,eAAS,CAACK,cAAV,GAA2BL,SAAS,CAACO,KAAV,CAAgBC,MAA3C;AACAR,eAAS,CAACM,YAAV,GAAyBN,SAAS,CAACO,KAAV,CAAgBC,MAAzC;AACA,KAHD,MAGO;AACNR,eAAS,CAACK,cAAV,GAA2B,CAA3B;AACAL,eAAS,CAACM,YAAV,GAAyB,CAAzB;AACA;;AACD;AACA;;AAEDN,WAAS,CAACoE,KAAV;;AAEA,MAAK,CAAEpE,SAAS,CAACS,iBAAjB,EAAqC;AACpC;AACA,GArBiE,CAuBlE;AACA;AACA;;;AACA,MAAM4D,WAAW,GAAGrE,SAAS,CAAEC,SAAS,GAAG,WAAH,GAAiB,YAA5B,CAA7B,CA1BkE,CA4BlE;AACA;;AACA,MAAK,CAAEoE,WAAP,EAAqB;AACpB;AACA;;AAhCiE,MAkC1DlF,aAlC0D,GAkCxCa,SAlCwC,CAkC1Db,aAlC0D;AAAA,MAmC1DC,WAnC0D,GAmC1CD,aAnC0C,CAmC1DC,WAnC0D;AAoClE,MAAME,SAAS,GAAGF,WAAW,CAACsB,YAAZ,EAAlB;AACA,MAAMI,KAAK,GAAG3B,aAAa,CAACqE,WAAd,EAAd;AAEA1C,OAAK,CAACwD,kBAAN,CAA0BD,WAA1B;AACAvD,OAAK,CAACI,QAAN,CAAgB,CAAEjB,SAAlB;AAEAX,WAAS,CAACiF,eAAV;AACAjF,WAAS,CAACkF,QAAV,CAAoB1D,KAApB;AACA;AAED;;;;;;;;;;;;;AAYA,SAAS2D,mBAAT,CAA8BC,GAA9B,EAAmCvC,CAAnC,EAAsCG,CAAtC,EAA0C;AACzC,MAAKoC,GAAG,CAACD,mBAAT,EAA+B;AAC9B,WAAOC,GAAG,CAACD,mBAAJ,CAAyBtC,CAAzB,EAA4BG,CAA5B,CAAP;AACA;;AAED,MAAK,CAAEoC,GAAG,CAACC,sBAAX,EAAoC;AACnC,WAAO,IAAP;AACA;;AAED,MAAMC,KAAK,GAAGF,GAAG,CAACC,sBAAJ,CAA4BxC,CAA5B,EAA+BG,CAA/B,CAAd,CATyC,CAWzC;AACA;;AACA,MAAK,CAAEsC,KAAP,EAAe;AACd,WAAO,IAAP;AACA;;AAED,MAAM9D,KAAK,GAAG4D,GAAG,CAAClB,WAAJ,EAAd;AAEA1C,OAAK,CAAC2C,QAAN,CAAgBmB,KAAK,CAACC,UAAtB,EAAkCD,KAAK,CAACE,MAAxC;AACAhE,OAAK,CAACI,QAAN,CAAgB,IAAhB;AAEA,SAAOJ,KAAP;AACA;AAED;;;;;;;;;;;;;;AAYA,SAAS0B,yBAAT,CAAoCkC,GAApC,EAAyCvC,CAAzC,EAA4CG,CAA5C,EAA+CtC,SAA/C,EAA2D;AAC1D,MAAM+E,cAAc,GAAG/E,SAAS,CAACgF,KAAV,CAAgBC,MAAvC;AACA,MAAMC,gBAAgB,GAAGlF,SAAS,CAACgF,KAAV,CAAgBrF,QAAzC,CAF0D,CAI1D;;AACAK,WAAS,CAACgF,KAAV,CAAgBC,MAAhB,GAAyB,OAAzB;AACAjF,WAAS,CAACgF,KAAV,CAAgBrF,QAAhB,GAA2B,UAA3B;AAEA,MAAMmB,KAAK,GAAG2D,mBAAmB,CAAEC,GAAF,EAAOvC,CAAP,EAAUG,CAAV,CAAjC;AAEAtC,WAAS,CAACgF,KAAV,CAAgBC,MAAhB,GAAyBF,cAAzB;AACA/E,WAAS,CAACgF,KAAV,CAAgBrF,QAAhB,GAA2BuF,gBAA3B;AAEA,SAAOpE,KAAP;AACA;AAED;;;;;;;;;;AAQO,SAASqE,wBAAT,CACNnF,SADM,EAENC,SAFM,EAGN0D,IAHM,EAKL;AAAA,MADDyB,YACC,uEADc,IACd;;AACD,MAAK,CAAEpF,SAAP,EAAmB;AAClB;AACA;;AAED,MAAK,CAAE2D,IAAF,IAAU,CAAE3D,SAAS,CAACS,iBAA3B,EAA+C;AAC9C0D,8BAA0B,CAAEnE,SAAF,EAAaC,SAAb,CAA1B;AACA;AACA,GARA,CAUD;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAMyB,MAAM,GAAGiC,IAAI,CAACnC,MAAL,GAAc,CAA7B;AACA,MAAM6D,YAAY,GAAGrF,SAAS,CAAC4B,qBAAV,EAArB;AACA,MAAMO,CAAC,GAAGwB,IAAI,CAACvB,IAAf;AACA,MAAME,CAAC,GAAGrC,SAAS,GAChBoF,YAAY,CAACrD,MAAb,GAAsBN,MADN,GAEhB2D,YAAY,CAACtD,GAAb,GAAmBL,MAFtB;AAnBC,MAuBOvC,aAvBP,GAuByBa,SAvBzB,CAuBOb,aAvBP;AAAA,MAwBOC,WAxBP,GAwBuBD,aAxBvB,CAwBOC,WAxBP;AAyBD,MAAM0B,KAAK,GAAG0B,yBAAyB,CAAErD,aAAF,EAAiBgD,CAAjB,EAAoBG,CAApB,EAAuBtC,SAAvB,CAAvC;;AAEA,MAAK,CAAEc,KAAF,IAAW,CAAEd,SAAS,CAACsF,QAAV,CAAoBxE,KAAK,CAACkC,cAA1B,CAAlB,EAA+D;AAC9D,QACCoC,YAAY,KACV,CAAEtE,KAAF,IACD,CAAEA,KAAK,CAACkC,cADP,IAED,CAAElC,KAAK,CAACkC,cAAN,CAAqBsC,QAArB,CAA+BtF,SAA/B,CAHS,CADb,EAKE;AACD;AACA;AACAA,eAAS,CAACuF,cAAV,CAA0BtF,SAA1B;AACAkF,8BAAwB,CAAEnF,SAAF,EAAaC,SAAb,EAAwB0D,IAAxB,EAA8B,KAA9B,CAAxB;AACA;AACA;;AAEDQ,8BAA0B,CAAEnE,SAAF,EAAaC,SAAb,CAA1B;AACA;AACA;;AAED,MAAMX,SAAS,GAAGF,WAAW,CAACsB,YAAZ,EAAlB;AACApB,WAAS,CAACiF,eAAV;AACAjF,WAAS,CAACkF,QAAV,CAAoB1D,KAApB;AACAd,WAAS,CAACoE,KAAV,GAhDC,CAiDD;AACA;;AACA9E,WAAS,CAACiF,eAAV;AACAjF,WAAS,CAACkF,QAAV,CAAoB1D,KAApB;AACA;AAED;;;;;;;;;;;AAUO,SAAS0E,WAAT,CAAsBC,OAAtB,EAAgC;AAAA,MAC9BxC,QAD8B,GACAwC,OADA,CAC9BxC,QAD8B;AAAA,MACpByC,eADoB,GACAD,OADA,CACpBC,eADoB;AAEtC,MAAMC,aAAa,GAAG,CACrB,QADqB,EAErB,UAFqB,EAGrB,QAHqB,EAIrB,MAJqB,EAKrB,OALqB,EAMrB,OANqB,EAOrB,OAPqB,EAQrB,OARqB,EASrB,QATqB,EAUrB,QAVqB,CAAtB;AAYA,SACG1C,QAAQ,KAAK,OAAb,IAAwB,CAAE0C,aAAa,CAACxF,QAAd,CAAwBsF,OAAO,CAACG,IAAhC,CAA5B,IACA3C,QAAQ,KAAK,UADb,IAEAyC,eAAe,KAAK,MAHrB;AAKA;AAED;;;;;;;;;AAQO,SAASG,aAAT,CAAwBJ,OAAxB,EAAkC;AAAA,MAChCxC,QADgC,GACEwC,OADF,CAChCxC,QADgC;AAAA,MACtB2C,IADsB,GACEH,OADF,CACtBG,IADsB;AAAA,MAChBE,aADgB,GACEL,OADF,CAChBK,aADgB;AAGxC,SAAO7C,QAAQ,KAAK,OAAb,IAAwB2C,IAAI,KAAK,QAAjC,IAA6C,CAAC,CAAEE,aAAvD;AACA;AAED;;;;;;;;;;;;AAWO,SAASC,wBAAT,CAAmCrB,GAAnC,EAAyC;AAC/C,MAAMpF,SAAS,GAAGoF,GAAG,CAACtF,WAAJ,CAAgBsB,YAAhB,EAAlB;AACA,MAAMI,KAAK,GAAGxB,SAAS,CAACqB,UAAV,GAAuBrB,SAAS,CAACuB,UAAV,CAAsB,CAAtB,CAAvB,GAAmD,IAAjE;AACA,SAAOC,KAAK,IAAI,CAAEA,KAAK,CAACiC,SAAxB;AACA;AAED;;;;;;;;;;;;;;AAaA,SAASiD,iCAAT,CAA4CP,OAA5C,EAAsD;AACrD,MAAK,CAAED,WAAW,CAAEC,OAAF,CAAb,IAA4B,CAAEI,aAAa,CAAEJ,OAAF,CAAhD,EAA8D;AAC7D,WAAO,KAAP;AACA;;AACD,MAAI;AAAA,QACKpF,cADL,GACsCoF,OADtC,CACKpF,cADL;AAAA,QACqBC,YADrB,GACsCmF,OADtC,CACqBnF,YADrB;AAGH,WAAOD,cAAc,KAAK,IAAnB,IAA2BA,cAAc,KAAKC,YAArD;AACA,GAJD,CAIE,OAAQ2F,KAAR,EAAgB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAO,KAAP;AACA;AACD;AAED;;;;;;;;;;;AASO,SAASC,+BAAT,CAA0CxB,GAA1C,EAAgD;AACtD,SACCqB,wBAAwB,CAAErB,GAAF,CAAxB,IACAsB,iCAAiC,CAAEtB,GAAG,CAACyB,aAAN,CAFlC;AAIA;AAED;;;;;;;;;AAQO,SAASC,oBAAT,CAA+B1B,GAA/B,EAAqC;AAC3C,SACCc,WAAW,CAAEd,GAAG,CAACyB,aAAN,CAAX,IACAN,aAAa,CAAEnB,GAAG,CAACyB,aAAN,CADb,IAEAJ,wBAAwB,CAAErB,GAAF,CAHzB;AAKA;AAED;;;;;;;;;AAQO,SAAS2B,kBAAT,CAA6BZ,OAA7B,EAAuC;AAC7C,MAAKtF,uDAAQ,CAAE,CAAE,OAAF,EAAW,UAAX,CAAF,EAA2BsF,OAAO,CAACxC,QAAnC,CAAb,EAA6D;AAC5D,WACCwC,OAAO,CAACpF,cAAR,KAA2B,CAA3B,IACAoF,OAAO,CAAClF,KAAR,CAAcC,MAAd,KAAyBiF,OAAO,CAACnF,YAFlC;AAIA;;AAED,MAAK,CAAEmF,OAAO,CAAChF,iBAAf,EAAmC;AAClC,WAAO,IAAP;AACA;;AAV4C,MAYrCtB,aAZqC,GAYnBsG,OAZmB,CAYrCtG,aAZqC;AAAA,MAarCC,WAbqC,GAarBD,aAbqB,CAarCC,WAbqC;AAc7C,MAAME,SAAS,GAAGF,WAAW,CAACsB,YAAZ,EAAlB;AACA,MAAMI,KAAK,GAAGxB,SAAS,CAACqB,UAAV,GAAuBrB,SAAS,CAACuB,UAAV,CAAsB,CAAtB,CAAvB,GAAmD,IAAjE;;AAEA,MAAK,CAAEC,KAAP,EAAe;AACd,WAAO,IAAP;AACA;;AAnB4C,MAqBrCkC,cArBqC,GAqBoBlC,KArBpB,CAqBrCkC,cArBqC;AAAA,MAqBrBsD,YArBqB,GAqBoBxF,KArBpB,CAqBrBwF,YArBqB;AAAA,MAqBPC,WArBO,GAqBoBzF,KArBpB,CAqBPyF,WArBO;AAAA,MAqBMC,SArBN,GAqBoB1F,KArBpB,CAqBM0F,SArBN;;AAuB7C,MACCxD,cAAc,KAAKyC,OAAnB,IACAa,YAAY,KAAKb,OADjB,IAEAc,WAAW,KAAK,CAFhB,IAGAC,SAAS,KAAKf,OAAO,CAACnC,UAAR,CAAmB9C,MAJlC,EAKE;AACD,WAAO,IAAP;AACA;;AAED,MAAMiG,SAAS,GAAGhB,OAAO,CAACgB,SAA1B;AACA,MAAMC,sBAAsB,GAC3BD,SAAS,CAACE,QAAV,KAAuBF,SAAS,CAACG,SAAjC,GACGH,SAAS,CAACI,IAAV,CAAerG,MADlB,GAEGiG,SAAS,CAACnD,UAAV,CAAqB9C,MAHzB;AAKA,SACCwC,cAAc,KAAKyC,OAAO,CAACqB,UAA3B,IACAR,YAAY,KAAKb,OAAO,CAACgB,SADzB,IAEAF,WAAW,KAAK,CAFhB,IAGAC,SAAS,KAAKE,sBAJf;AAMA;AAED;;;;;;;;AAOO,SAASK,kBAAT,CAA6B7H,IAA7B,EAAoC;AAC1C,MAAK,CAAEA,IAAP,EAAc;AACb;AACA,GAHyC,CAK1C;;;AACA,MAAKA,IAAI,CAAC8H,YAAL,GAAoB9H,IAAI,CAAC+H,YAA9B,EAA6C;AAC5C;AAD4C,4BAEtBhI,gBAAgB,CAAEC,IAAF,CAFM;AAAA,QAEpCgI,SAFoC,qBAEpCA,SAFoC;;AAG5C,QAAK,gBAAgBC,IAAhB,CAAsBD,SAAtB,CAAL,EAAyC;AACxC,aAAOhI,IAAP;AACA;AACD,GAZyC,CAc1C;;;AACA,SAAO6H,kBAAkB,CAAE7H,IAAI,CAACgE,UAAP,CAAzB;AACA;AAED;;;;;;;;;;;;AAWO,SAASkE,eAAT,CAA0BlI,IAA1B,EAAiC;AACvC;AACA;AACA,MAAImI,cAAJ;;AACA,SAAUA,cAAc,GAAGnI,IAAI,CAACgE,UAAhC,EAA+C;AAC9C,QAAKmE,cAAc,CAACV,QAAf,KAA4BU,cAAc,CAACC,YAAhD,EAA+D;AAC9D;AACA;AACD;;AAED,MAAK,CAAED,cAAP,EAAwB;AACvB,WAAO,IAAP;AACA,GAZsC,CAcvC;AACA;;;AACA,MAAKpI,gBAAgB,CAAEoI,cAAF,CAAhB,CAAmC1H,QAAnC,KAAgD,QAArD,EAAgE;AAC/D,WAAO0H,cAAP;AACA;;AAED,SAAOA,cAAc,CAACE,YAAtB;AACA;AAED;;;;;;;;AAOO,SAASC,OAAT,CAAkBC,aAAlB,EAAiCC,OAAjC,EAA2C;AACjDC,aAAW,CAAED,OAAF,EAAWD,aAAa,CAACvE,UAAzB,CAAX;AACA0E,QAAM,CAAEH,aAAF,CAAN;AACA;AAED;;;;;;;AAMO,SAASG,MAAT,CAAiB1I,IAAjB,EAAwB;AAC9BA,MAAI,CAACgE,UAAL,CAAgBc,WAAhB,CAA6B9E,IAA7B;AACA;AAED;;;;;;;;;AAQO,SAASyI,WAAT,CAAsBD,OAAtB,EAA+BG,aAA/B,EAA+C;AACrDA,eAAa,CAAC3E,UAAd,CAAyB4E,YAAzB,CAAuCJ,OAAvC,EAAgDG,aAAa,CAACE,WAA9D;AACA;AAED;;;;;;;;AAOO,SAASC,MAAT,CAAiB9I,IAAjB,EAAwB;AAC9B,MAAM+I,MAAM,GAAG/I,IAAI,CAACgE,UAApB;;AAEA,SAAQhE,IAAI,CAAC4H,UAAb,EAA0B;AACzBmB,UAAM,CAACH,YAAP,CAAqB5I,IAAI,CAAC4H,UAA1B,EAAsC5H,IAAtC;AACA;;AAED+I,QAAM,CAACjE,WAAP,CAAoB9E,IAApB;AACA;AAED;;;;;;;;;AAQO,SAASgJ,UAAT,CAAqBhJ,IAArB,EAA2BkB,OAA3B,EAAqC;AAC3C,MAAMsH,OAAO,GAAGxI,IAAI,CAACC,aAAL,CAAmBgJ,aAAnB,CAAkC/H,OAAlC,CAAhB;;AAEA,SAAQlB,IAAI,CAAC4H,UAAb,EAA0B;AACzBY,WAAO,CAACU,WAAR,CAAqBlJ,IAAI,CAAC4H,UAA1B;AACA;;AAED5H,MAAI,CAACgE,UAAL,CAAgBmF,YAAhB,CAA8BX,OAA9B,EAAuCxI,IAAvC;AAEA,SAAOwI,OAAP;AACA;AAED;;;;;;;AAMO,SAASY,IAAT,CAAeZ,OAAf,EAAwBG,aAAxB,EAAwC;AAC9CA,eAAa,CAAC3E,UAAd,CAAyB4E,YAAzB,CAAuCJ,OAAvC,EAAgDG,aAAhD;AACAH,SAAO,CAACU,WAAR,CAAqBP,aAArB;AACA;AAED;;;;;;;;AAOO,SAASU,mBAAT,CAA8BC,IAA9B,EAAqC;AAC3C,MAAMC,QAAQ,GAAG,IAAIC,MAAM,CAACC,SAAX,GAAuBC,eAAvB,CAChBJ,IADgB,EAEhB,WAFgB,CAAjB;AAIA,SAAOC,QAAQ,CAACI,IAAT,CAAcC,WAAd,IAA6B,EAApC;AACA;AAED;;;;;;;;;;AASA,SAASC,aAAT,CAAwBC,QAAxB,EAAkCtE,GAAlC,EAAuCuE,MAAvC,EAA+CC,MAA/C,EAAwD;AACvD9F,OAAK,CAACC,IAAN,CAAY2F,QAAZ,EAAuBG,OAAvB,CAAgC,UAAEjK,IAAF,EAAY;AAC3C,QAAMkK,GAAG,GAAGlK,IAAI,CAAC+D,QAAL,CAAcoG,WAAd,EAAZ,CAD2C,CAG3C;AACA;;AACA,QACCJ,MAAM,CAACK,cAAP,CAAuBF,GAAvB,MACE,CAAEH,MAAM,CAAEG,GAAF,CAAN,CAAcG,OAAhB,IAA2BN,MAAM,CAAEG,GAAF,CAAN,CAAcG,OAAd,CAAuBrK,IAAvB,CAD7B,CADD,EAGE;AACD,UAAKA,IAAI,CAACyH,QAAL,KAAkBzH,IAAI,CAACoI,YAA5B,EAA2C;AAAA,0BAOtC2B,MAAM,CAAEG,GAAF,CAPgC;AAAA,gDAEzCI,UAFyC;AAAA,YAEzCA,UAFyC,sCAE5B,EAF4B;AAAA,8CAGzCC,OAHyC;AAAA,YAGzCA,OAHyC,oCAG/B,EAH+B;AAAA,YAIzCC,QAJyC,eAIzCA,QAJyC;AAAA,8CAKzCC,OALyC;AAAA,YAKzCA,OALyC,oCAK/B,EAL+B;AAAA,YAMzCC,UANyC,eAMzCA,UANyC,EAS1C;AACA;;;AACA,YAAKF,QAAQ,IAAI,CAAEE,UAAd,IAA4BC,OAAO,CAAE3K,IAAF,CAAxC,EAAmD;AAClD0I,gBAAM,CAAE1I,IAAF,CAAN;AACA;AACA;;AAED,YAAKA,IAAI,CAAC4K,aAAL,EAAL,EAA4B;AAC3B;AACA1G,eAAK,CAACC,IAAN,CAAYnE,IAAI,CAACsK,UAAjB,EAA8BL,OAA9B,CAAuC,gBAAgB;AAAA,gBAAZY,IAAY,QAAZA,IAAY;;AACtD,gBACCA,IAAI,KAAK,OAAT,IACA,CAAE5J,uDAAQ,CAAEqJ,UAAF,EAAcO,IAAd,CAFX,EAGE;AACD7K,kBAAI,CAAC8K,eAAL,CAAsBD,IAAtB;AACA;AACD,WAPD,EAF2B,CAW3B;AACA;AACA;;AACA,cAAK7K,IAAI,CAAC+K,SAAL,IAAkB/K,IAAI,CAAC+K,SAAL,CAAezJ,MAAtC,EAA+C;AAC9C,gBAAM0J,SAAS,GAAGT,OAAO,CAACU,GAAR,CAAa,UAAEC,IAAF,EAAY;AAC1C,kBAAK,OAAOA,IAAP,KAAgB,QAArB,EAAgC;AAC/B,uBAAO,UAAEC,SAAF;AAAA,yBAAiBA,SAAS,KAAKD,IAA/B;AAAA,iBAAP;AACA,eAFD,MAEO,IAAKA,IAAI,YAAYE,MAArB,EAA8B;AACpC,uBAAO,UAAED,SAAF;AAAA,yBAAiBD,IAAI,CAACjD,IAAL,CAAWkD,SAAX,CAAjB;AAAA,iBAAP;AACA;;AAED,qBAAOE,2CAAP;AACA,aARiB,CAAlB;AAUAnH,iBAAK,CAACC,IAAN,CAAYnE,IAAI,CAAC+K,SAAjB,EAA6Bd,OAA7B,CAAsC,UAAEY,IAAF,EAAY;AACjD,kBACC,CAAEG,SAAS,CAACM,IAAV,CAAgB,UAAEjB,OAAF;AAAA,uBACjBA,OAAO,CAAEQ,IAAF,CADU;AAAA,eAAhB,CADH,EAIE;AACD7K,oBAAI,CAAC+K,SAAL,CAAerC,MAAf,CAAuBmC,IAAvB;AACA;AACD,aARD;;AAUA,gBAAK,CAAE7K,IAAI,CAAC+K,SAAL,CAAezJ,MAAtB,EAA+B;AAC9BtB,kBAAI,CAAC8K,eAAL,CAAsB,OAAtB;AACA;AACD;AACD;;AAED,YAAK9K,IAAI,CAACuL,aAAL,EAAL,EAA4B;AAC3B;AACA,cAAKf,QAAQ,KAAK,GAAlB,EAAwB;AACvB;AACA,WAJ0B,CAM3B;;;AACA,cAAKA,QAAL,EAAgB;AACf;AACA;AACA,gBACCC,OAAO,CAACnJ,MAAR,IACA,CAAEtB,IAAI,CAACwL,aAAL,CAAoBf,OAAO,CAACgB,IAAR,CAAc,GAAd,CAApB,CAFH,EAGE;AACD5B,2BAAa,CACZ7J,IAAI,CAACoE,UADO,EAEZoB,GAFY,EAGZuE,MAHY,EAIZC,MAJY,CAAb;AAMAlB,oBAAM,CAAE9I,IAAF,CAAN,CAPC,CAQD;AACA;AACA;AACA,aAdD,MAcO,IACNA,IAAI,CAACgE,UAAL,CAAgBD,QAAhB,KAA6B,MAA7B,IACA2H,2EAAiB,CAAE1L,IAAF,CAFX,EAGL;AACD6J,2BAAa,CACZ7J,IAAI,CAACoE,UADO,EAEZoB,GAFY,EAGZuE,MAHY,EAIZC,MAJY,CAAb;;AAOA,kBACC9F,KAAK,CAACC,IAAN,CAAYnE,IAAI,CAACoE,UAAjB,EAA8BkH,IAA9B,CACC,UAAEK,KAAF;AAAA,uBAAa,CAAED,2EAAiB,CAAEC,KAAF,CAAhC;AAAA,eADD,CADD,EAIE;AACD7C,sBAAM,CAAE9I,IAAF,CAAN;AACA;AACD,aAlBM,MAkBA;AACN6J,2BAAa,CACZ7J,IAAI,CAACoE,UADO,EAEZoB,GAFY,EAGZgF,QAHY,EAIZR,MAJY,CAAb;AAMA,aA1Cc,CA2Cf;;AACA,WA5CD,MA4CO;AACN,mBAAQhK,IAAI,CAAC4H,UAAb,EAA0B;AACzBc,oBAAM,CAAE1I,IAAI,CAAC4H,UAAP,CAAN;AACA;AACD;AACD;AACD,OAnHA,CAoHD;;AACA,KAxHD,MAwHO;AACNiC,mBAAa,CAAE7J,IAAI,CAACoE,UAAP,EAAmBoB,GAAnB,EAAwBuE,MAAxB,EAAgCC,MAAhC,CAAb,CADM,CAGN;AACA;;AACA,UACCA,MAAM,IACN,CAAE0B,2EAAiB,CAAE1L,IAAF,CADnB,IAEAA,IAAI,CAAC4L,kBAHN,EAIE;AACDnD,mBAAW,CAAEjD,GAAG,CAACyD,aAAJ,CAAmB,IAAnB,CAAF,EAA6BjJ,IAA7B,CAAX;AACA;;AAED8I,YAAM,CAAE9I,IAAF,CAAN;AACA;AACD,GA5ID;AA6IA;AAED;;;;;;;;;;AAQO,SAAS2K,OAAT,CAAkBpE,OAAlB,EAA4B;AAClC,MAAK,CAAEA,OAAO,CAACgF,aAAR,EAAP,EAAiC;AAChC,WAAO,IAAP;AACA;;AAED,SAAOrH,KAAK,CAACC,IAAN,CAAYoC,OAAO,CAACnC,UAApB,EAAiCyH,KAAjC,CAAwC,UAAE7L,IAAF,EAAY;AAC1D,QAAKA,IAAI,CAACyH,QAAL,KAAkBzH,IAAI,CAAC0H,SAA5B,EAAwC;AACvC,aAAO,CAAE1H,IAAI,CAAC8L,SAAL,CAAeC,IAAf,EAAT;AACA;;AAED,QAAK/L,IAAI,CAACyH,QAAL,KAAkBzH,IAAI,CAACoI,YAA5B,EAA2C;AAC1C,UAAKpI,IAAI,CAAC+D,QAAL,KAAkB,IAAvB,EAA8B;AAC7B,eAAO,IAAP;AACA,OAFD,MAEO,IAAK/D,IAAI,CAAC4K,aAAL,EAAL,EAA4B;AAClC,eAAO,KAAP;AACA;;AAED,aAAOD,OAAO,CAAE3K,IAAF,CAAd;AACA;;AAED,WAAO,IAAP;AACA,GAhBM,CAAP;AAiBA;AAED;;;;;;;;;;AASO,SAASgM,iBAAT,CAA4BC,IAA5B,EAAkClC,MAAlC,EAA0CC,MAA1C,EAAmD;AACzD,MAAMxE,GAAG,GAAG+D,QAAQ,CAAC2C,cAAT,CAAwBC,kBAAxB,CAA4C,EAA5C,CAAZ;AAEA3G,KAAG,CAACmE,IAAJ,CAASyC,SAAT,GAAqBH,IAArB;AAEApC,eAAa,CAAErE,GAAG,CAACmE,IAAJ,CAASvF,UAAX,EAAuBoB,GAAvB,EAA4BuE,MAA5B,EAAoCC,MAApC,CAAb;AAEA,SAAOxE,GAAG,CAACmE,IAAJ,CAASyC,SAAhB;AACA;;;;;;;;;;;;;AC/9BD;AAAA;AAAA;;;;;;;;;;;;;;;;;;AAmBA,IAAMC,QAAQ,GAAG,CAChB,YADgB,EAEhB,SAFgB,EAGhB,wBAHgB,EAIhB,4CAJgB,EAKhB,wBALgB,EAMhB,0BANgB,EAOhB,QAPgB,EAQhB,QARgB,EAShB,OATgB,EAUhB,YAVgB,EAWhB,gDAXgB,EAYfZ,IAZe,CAYT,GAZS,CAAjB;AAcA;;;;;;;;;AAQA,SAASa,SAAT,CAAoB/F,OAApB,EAA8B;AAC7B,SACCA,OAAO,CAACgG,WAAR,GAAsB,CAAtB,IACAhG,OAAO,CAACiG,YAAR,GAAuB,CADvB,IAEAjG,OAAO,CAAC7B,cAAR,GAAyBpD,MAAzB,GAAkC,CAHnC;AAKA;AAED;;;;;;;;;;AAQA,SAASmL,SAAT,CAAoBlG,OAApB,EAA8B;AAC7B,SACCA,OAAO,CAACxC,QAAR,CAAiBoG,WAAjB,OAAmC,QAAnC,IACA5D,OAAO,CAACmG,YAAR,CAAsB,UAAtB,MAAuC,IAFxC;AAIA;AAED;;;;;;;;;;;AASA,SAASC,oBAAT,CAA+BpG,OAA/B,EAAyC;AACxC,MAAM0E,GAAG,GAAG1E,OAAO,CAACqG,OAAR,CAAiB,WAAjB,CAAZ;;AACA,MAAK,CAAE3B,GAAP,EAAa;AACZ,WAAO,KAAP;AACA;;AAED,MAAM4B,GAAG,GAAGtG,OAAO,CAACtG,aAAR,CAAsBuL,aAAtB,CACX,kBAAkBP,GAAG,CAACJ,IAAtB,GAA6B,IADlB,CAAZ;AAGA,SAAO,CAAC,CAAEgC,GAAH,IAAUP,SAAS,CAAEO,GAAF,CAA1B;AACA;AAED;;;;;;;;;AAOO,SAASC,IAAT,CAAeC,OAAf,EAAyB;AAC/B,MAAMC,QAAQ,GAAGD,OAAO,CAACE,gBAAR,CAA0BZ,QAA1B,CAAjB;AAEA,SAAOnI,KAAK,CAACC,IAAN,CAAY6I,QAAZ,EAAuBE,MAAvB,CAA+B,UAAE3G,OAAF,EAAe;AACpD,QAAK,CAAE+F,SAAS,CAAE/F,OAAF,CAAX,IAA0BkG,SAAS,CAAElG,OAAF,CAAxC,EAAsD;AACrD,aAAO,KAAP;AACA;;AAHmD,QAK5CxC,QAL4C,GAK/BwC,OAL+B,CAK5CxC,QAL4C;;AAMpD,QAAK,WAAWA,QAAhB,EAA2B;AAC1B,aAAO4I,oBAAoB,CAAEpG,OAAF,CAA3B;AACA;;AAED,WAAO,IAAP;AACA,GAXM,CAAP;AAYA;;;;;;;;;;;;;AC3GD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAGA;AACA;AAEA;;;;;AAIO,IAAMrB,KAAK,GAAG;AAAEiI,WAAS,EAATA,uCAAF;AAAaC,UAAQ,EAARA,sCAAQA;AAArB,CAAd;AAEP;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;ACbA;;;AAGA;AAEA;;;;;;AAMA;;;;;;AAKA,IAAMC,iBAAiB,GAAG;AACzBC,QAAM,EAAE,EADiB;AAEzBC,IAAE,EAAE,EAFqB;AAGzBC,GAAC,EAAE,EAHsB;AAIzBC,KAAG,EAAE,EAJoB;AAKzBC,KAAG,EAAE,EALoB;AAMzBC,GAAC,EAAE;AAAErD,cAAU,EAAE,CAAE,MAAF,EAAU,QAAV,EAAoB,KAApB;AAAd,GANsB;AAOzBsD,MAAI,EAAE,EAPmB;AAQzBC,MAAI,EAAE;AAAEvD,cAAU,EAAE,CAAE,OAAF;AAAd,GARmB;AASzBwD,KAAG,EAAE,EAToB;AAUzBC,KAAG,EAAE,EAVoB;AAWzBC,IAAE,EAAE,EAXqB;AAYzBC,OAAK,EAAE,EAZkB;AAazB;AACA;AACAC,GAAC,EAAE;AAAE5D,cAAU,EAAE,CAAE,MAAF;AAAd,GAfsB;AAgBzB6D,KAAG,EAAE;AAAE7D,cAAU,EAAE,CAAE,OAAF;AAAd,GAhBoB;AAiBzB3C,MAAI,EAAE;AAAE2C,cAAU,EAAE,CAAE,OAAF;AAAd,GAjBmB;AAkBzB8D,MAAI,EAAE;AAAE9D,cAAU,EAAE,CAAE,UAAF;AAAd,GAlBmB;AAmBzB+D,KAAG,EAAE,EAnBoB;AAoBzBC,MAAI,EAAE,EApBmB;AAqBzBC,KAAG,EAAE,EArBoB;AAsBzBC,GAAC,EAAE,EAtBsB;AAuBzBC,GAAC,EAAE,EAvBsB;AAwBzBC,GAAC,EAAE,EAxBsB;AAyBzBC,MAAI,EAAE,EAzBmB;AA0BzBC,MAAI,EAAE,EA1BmB;AA2BzBC,IAAE,EAAE,EA3BqB;AA4BzBC,IAAE,EAAE,EA5BqB;AA6BzBC,KAAG,EAAE;AAAEzE,cAAU,EAAE,CAAE,KAAF;AAAd,GA7BoB;AA8BzB0E,KAAG,EAAE;AAAE1E,cAAU,EAAE,CAAE,KAAF;AAAd,GA9BoB;AA+BzB2E,KAAG,EAAE,EA/BoB;AAgCzB,WAAS;AAhCgB,CAA1B,C,CAmCA;AACA;AACA;;AACAC,sDAAO,CAAEC,MAAM,CAACC,IAAP,CAAa/B,iBAAb,CAAF,EAAoC,OAApC,EAA6C,IAA7C,CAAP,CAA2DpD,OAA3D,CAAoE,UAAEC,GAAF,EAAW;AAC9EmD,mBAAiB,CAAEnD,GAAF,CAAjB,CAAyBM,QAAzB,GAAoC6E,mDAAI,CAAEhC,iBAAF,EAAqBnD,GAArB,CAAxC;AACA,CAFD;AAIA;;;;;;AAKA,IAAMoF,qBAAqB,GAAG;AAC7BC,OAAK,EAAE;AACNjF,cAAU,EAAE,CACX,KADW,EAEX,SAFW,EAGX,UAHW,EAIX,YAJW,EAKX,MALW,EAMX,OANW;AADN,GADsB;AAW7BkF,QAAM,EAAE;AAAElF,cAAU,EAAE,CAAE,OAAF,EAAW,QAAX;AAAd,GAXqB;AAY7BmF,OAAK,EAAE;AAAEnF,cAAU,EAAE,CAAE,KAAF,EAAS,MAAT,EAAiB,OAAjB,EAA0B,QAA1B;AAAd,GAZsB;AAa7BuC,KAAG,EAAE;AACJvC,cAAU,EAAE,CACX,KADW,EAEX,KAFW,EAGX,QAHW,EAIX,QAJW,EAKX,OALW,EAMX,OANW,EAOX,QAPW;AADR,GAbwB;AAwB7BoF,QAAM,EAAE;AACPpF,cAAU,EAAE,CACX,MADW,EAEX,MAFW,EAGX,MAHW,EAIX,QAJW,EAKX,MALW,EAMX,OANW,EAOX,QAPW;AADL,GAxBqB;AAmC7BqF,OAAK,EAAE;AACNrF,cAAU,EAAE,CACX,KADW,EAEX,QAFW,EAGX,SAHW,EAIX,UAJW,EAKX,YALW,EAMX,MANW,EAOX,OAPW,EAQX,UARW,EASX,OATW,EAUX,QAVW;AADN;AAnCsB,CAA9B;AAmDA;;;;;;AAKA,IAAMsF,qBAAqB,mCACvBvC,iBADuB,GAEvBiC,qBAFuB,CAA3B;AAKA;;;;;;;;;;;;AAUO,SAASO,wBAAT,CAAmC9C,OAAnC,EAA6C;AACnD,MAAKA,OAAO,KAAK,OAAjB,EAA2B;AAC1B,WAAO6C,qBAAP;AACA;;AAED,SAAOP,mDAAI,iCAENO,qBAFM;AAGT;AACA;AACAlC,OAAG,EAAE;AAAElD,cAAQ,EAAEoF,qBAAqB,CAAClC,GAAtB,CAA0BlD;AAAtC,KALI;AAMTiD,OAAG,EAAE;AAAEjD,cAAQ,EAAEoF,qBAAqB,CAACnC,GAAtB,CAA0BjD;AAAtC;AANI,MAQV,CACC,GADD,EACM;AACL,QAFD,EAES;AACR,QAHD,EAGS;AACR,QAJD,EAIS;AACR,OALD,EAKQ;AACP,OAND,EAMQ;AACP,OAPD,CAOQ;AAPR,GARU,CAAX;AAkBA;AAED;;;;;;;;;;AASO,SAASkB,iBAAT,CAA4B1L,IAA5B,EAAmC;AACzC,MAAMkK,GAAG,GAAGlK,IAAI,CAAC+D,QAAL,CAAcoG,WAAd,EAAZ;AACA,SAAO0F,wBAAwB,GAAGzF,cAA3B,CAA2CF,GAA3C,KAAoDA,GAAG,KAAK,MAAnE;AACA;AAEM,SAAS4F,aAAT,CAAwB9P,IAAxB,EAA+B;AACrC,MAAMkK,GAAG,GAAGlK,IAAI,CAAC+D,QAAL,CAAcoG,WAAd,EAAZ;AACA,SAAOkD,iBAAiB,CAACjD,cAAlB,CAAkCF,GAAlC,KAA2CA,GAAG,KAAK,MAA1D;AACA;;;;;;;;;;;;;AChLD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAGA;AAEA;;;;AAGA;AAEA;;;;;;;;;;;;;AAYA,SAAS6F,WAAT,CAAsBxJ,OAAtB,EAAgC;AAC/B,MAAMyJ,QAAQ,GAAGzJ,OAAO,CAACmG,YAAR,CAAsB,UAAtB,CAAjB;AACA,SAAOsD,QAAQ,KAAK,IAAb,GAAoB,CAApB,GAAwB3N,QAAQ,CAAE2N,QAAF,EAAY,EAAZ,CAAvC;AACA;AAED;;;;;;;;;AAOO,SAASC,eAAT,CAA0B1J,OAA1B,EAAoC;AAC1C,SAAOwJ,WAAW,CAAExJ,OAAF,CAAX,KAA2B,CAAC,CAAnC;AACA;AAED;;;;;;;;;AAQA,SAAS2J,gCAAT,GAA4C;AAC3C,MAAMC,oBAAoB,GAAG,EAA7B;AAEA,SAAO,SAASC,kBAAT,CAA6BC,MAA7B,EAAqC9J,OAArC,EAA+C;AAAA,QAC7CxC,QAD6C,GACXwC,OADW,CAC7CxC,QAD6C;AAAA,QACnC2C,IADmC,GACXH,OADW,CACnCG,IADmC;AAAA,QAC7B4J,OAD6B,GACX/J,OADW,CAC7B+J,OAD6B;AAAA,QACpBzF,IADoB,GACXtE,OADW,CACpBsE,IADoB,EAGrD;;AACA,QAAK9G,QAAQ,KAAK,OAAb,IAAwB2C,IAAI,KAAK,OAAjC,IAA4C,CAAEmE,IAAnD,EAA0D;AACzD,aAAOwF,MAAM,CAACE,MAAP,CAAehK,OAAf,CAAP;AACA;;AAED,QAAMiK,SAAS,GAAGL,oBAAoB,CAAC/F,cAArB,CAAqCS,IAArC,CAAlB,CARqD,CAUrD;;AACA,QAAM4F,QAAQ,GAAGH,OAAO,IAAI,CAAEE,SAA9B;;AACA,QAAK,CAAEC,QAAP,EAAkB;AACjB,aAAOJ,MAAP;AACA,KAdoD,CAgBrD;AACA;AACA;;;AACA,QAAKG,SAAL,EAAiB;AAChB,UAAME,gBAAgB,GAAGP,oBAAoB,CAAEtF,IAAF,CAA7C;AACAwF,YAAM,GAAGnB,sDAAO,CAAEmB,MAAF,EAAUK,gBAAV,CAAhB;AACA;;AAEDP,wBAAoB,CAAEtF,IAAF,CAApB,GAA+BtE,OAA/B;AAEA,WAAO8J,MAAM,CAACE,MAAP,CAAehK,OAAf,CAAP;AACA,GA3BD;AA4BA;AAED;;;;;;;;;;;;;AAWA,SAASoK,0BAAT,CAAqCpK,OAArC,EAA8CtC,KAA9C,EAAsD;AACrD,SAAO;AAAEsC,WAAO,EAAPA,OAAF;AAAWtC,SAAK,EAALA;AAAX,GAAP;AACA;AAED;;;;;;;;;;AAQA,SAAS2M,0BAAT,CAAqClB,MAArC,EAA8C;AAC7C,SAAOA,MAAM,CAACnJ,OAAd;AACA;AAED;;;;;;;;;;;;AAUA,SAASsK,sBAAT,CAAiClD,CAAjC,EAAoCc,CAApC,EAAwC;AACvC,MAAMqC,SAAS,GAAGf,WAAW,CAAEpC,CAAC,CAACpH,OAAJ,CAA7B;AACA,MAAMwK,SAAS,GAAGhB,WAAW,CAAEtB,CAAC,CAAClI,OAAJ,CAA7B;;AAEA,MAAKuK,SAAS,KAAKC,SAAnB,EAA+B;AAC9B,WAAOpD,CAAC,CAAC1J,KAAF,GAAUwK,CAAC,CAACxK,KAAnB;AACA;;AAED,SAAO6M,SAAS,GAAGC,SAAnB;AACA;AAED;;;;;;;;;AAOA,SAASC,cAAT,CAAyBC,UAAzB,EAAsC;AACrC,SAAOA,UAAU,CACf/D,MADK,CACG+C,eADH,EAELhF,GAFK,CAEA0F,0BAFA,EAGLO,IAHK,CAGCL,sBAHD,EAIL5F,GAJK,CAIA2F,0BAJA,EAKLO,MALK,CAKGjB,gCAAgC,EALnC,EAKuC,EALvC,CAAP;AAMA;;AAEM,SAASpD,IAAT,CAAeC,OAAf,EAAyB;AAC/B,SAAOiE,cAAc,CAAEI,uDAAa,CAAErE,OAAF,CAAf,CAArB;AACA;AAED;;;;;;;AAMO,SAASsE,YAAT,CAAuB9K,OAAvB,EAAiC;AACvC,MAAM0K,UAAU,GAAGG,uDAAa,CAAE7K,OAAO,CAACtG,aAAR,CAAsB0J,IAAxB,CAAhC;AACA,MAAM1F,KAAK,GAAGgN,UAAU,CAAC5M,OAAX,CAAoBkC,OAApB,CAAd,CAFuC,CAIvC;;AACA0K,YAAU,CAAC3P,MAAX,GAAoB2C,KAApB;AAEA,SAAOqN,mDAAI,CAAEN,cAAc,CAAEC,UAAF,CAAhB,CAAX;AACA;AAED;;;;;;;AAMO,SAASM,QAAT,CAAmBhL,OAAnB,EAA6B;AACnC,MAAM0K,UAAU,GAAGG,uDAAa,CAAE7K,OAAO,CAACtG,aAAR,CAAsB0J,IAAxB,CAAhC;AACA,MAAM1F,KAAK,GAAGgN,UAAU,CAAC5M,OAAX,CAAoBkC,OAApB,CAAd,CAFmC,CAInC;;AACA,MAAMiL,SAAS,GAAGP,UAAU,CAC1BQ,KADgB,CACTxN,KAAK,GAAG,CADC,EAEhBiJ,MAFgB,CAER,UAAElN,IAAF;AAAA,WAAY,CAAEuG,OAAO,CAACH,QAAR,CAAkBpG,IAAlB,CAAd;AAAA,GAFQ,CAAlB;AAIA,SAAO0R,oDAAK,CAAEV,cAAc,CAAEQ,SAAF,CAAhB,CAAZ;AACA;;;;;;;;;;;;ACnLD,aAAa,iCAAiC,EAAE,I","file":"dom.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./node_modules/@wordpress/dom/build-module/index.js\");\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","/**\n * External dependencies\n */\nimport { includes, noop } from 'lodash';\n\n/**\n * Internal dependencies\n */\nimport { isPhrasingContent } from './phrasing-content';\n\nfunction getComputedStyle( node ) {\n\treturn node.ownerDocument.defaultView.getComputedStyle( node );\n}\n\n/**\n * Returns true if the given selection object is in the forward direction, or\n * false otherwise.\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/compareDocumentPosition\n *\n * @param {Selection} selection Selection object to check.\n *\n * @return {boolean} Whether the selection is forward.\n */\nfunction isSelectionForward( selection ) {\n\tconst { anchorNode, focusNode, anchorOffset, focusOffset } = selection;\n\n\tconst position = anchorNode.compareDocumentPosition( focusNode );\n\n\t// Disable reason: `Node#compareDocumentPosition` returns a bitmask value,\n\t// so bitwise operators are intended.\n\t/* eslint-disable no-bitwise */\n\t// Compare whether anchor node precedes focus node. If focus node (where\n\t// end of selection occurs) is after the anchor node, it is forward.\n\tif ( position & anchorNode.DOCUMENT_POSITION_PRECEDING ) {\n\t\treturn false;\n\t}\n\n\tif ( position & anchorNode.DOCUMENT_POSITION_FOLLOWING ) {\n\t\treturn true;\n\t}\n\t/* eslint-enable no-bitwise */\n\n\t// `compareDocumentPosition` returns 0 when passed the same node, in which\n\t// case compare offsets.\n\tif ( position === 0 ) {\n\t\treturn anchorOffset <= focusOffset;\n\t}\n\n\t// This should never be reached, but return true as default case.\n\treturn true;\n}\n\n/**\n * Check whether the selection is at the edge of the container. Checks for\n * horizontal position by default. Set `onlyVertical` to true to check only\n * vertically.\n *\n * @param {Element} container    Focusable element.\n * @param {boolean} isReverse    Set to true to check left, false to check right.\n * @param {boolean} onlyVertical Set to true to check only vertical position.\n *\n * @return {boolean} True if at the edge, false if not.\n */\nfunction isEdge( container, isReverse, onlyVertical ) {\n\tif ( includes( [ 'INPUT', 'TEXTAREA' ], container.tagName ) ) {\n\t\tif ( container.selectionStart !== container.selectionEnd ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( isReverse ) {\n\t\t\treturn container.selectionStart === 0;\n\t\t}\n\n\t\treturn container.value.length === container.selectionStart;\n\t}\n\n\tif ( ! container.isContentEditable ) {\n\t\treturn true;\n\t}\n\n\tconst { ownerDocument } = container;\n\tconst { defaultView } = ownerDocument;\n\n\tconst selection = defaultView.getSelection();\n\n\tif ( ! selection.rangeCount ) {\n\t\treturn false;\n\t}\n\n\tconst originalRange = selection.getRangeAt( 0 );\n\tconst range = originalRange.cloneRange();\n\tconst isForward = isSelectionForward( selection );\n\tconst isCollapsed = selection.isCollapsed;\n\n\t// Collapse in direction of selection.\n\tif ( ! isCollapsed ) {\n\t\trange.collapse( ! isForward );\n\t}\n\n\tconst rangeRect = getRectangleFromRange( range );\n\n\tif ( ! rangeRect ) {\n\t\treturn false;\n\t}\n\n\tconst computedStyle = getComputedStyle( container );\n\tconst lineHeight = parseInt( computedStyle.lineHeight, 10 ) || 0;\n\n\t// Only consider the multiline selection at the edge if the direction is\n\t// towards the edge.\n\tif (\n\t\t! isCollapsed &&\n\t\trangeRect.height > lineHeight &&\n\t\tisForward === isReverse\n\t) {\n\t\treturn false;\n\t}\n\n\tconst padding =\n\t\tparseInt(\n\t\t\tcomputedStyle[ `padding${ isReverse ? 'Top' : 'Bottom' }` ],\n\t\t\t10\n\t\t) || 0;\n\n\t// Calculate a buffer that is half the line height. In some browsers, the\n\t// selection rectangle may not fill the entire height of the line, so we add\n\t// 3/4 the line height to the selection rectangle to ensure that it is well\n\t// over its line boundary.\n\tconst buffer = ( 3 * parseInt( lineHeight, 10 ) ) / 4;\n\tconst containerRect = container.getBoundingClientRect();\n\tconst originalRangeRect = getRectangleFromRange( originalRange );\n\tconst verticalEdge = isReverse\n\t\t? containerRect.top + padding > originalRangeRect.top - buffer\n\t\t: containerRect.bottom - padding < originalRangeRect.bottom + buffer;\n\n\tif ( ! verticalEdge ) {\n\t\treturn false;\n\t}\n\n\tif ( onlyVertical ) {\n\t\treturn true;\n\t}\n\n\t// In the case of RTL scripts, the horizontal edge is at the opposite side.\n\tconst { direction } = computedStyle;\n\tconst isReverseDir = direction === 'rtl' ? ! isReverse : isReverse;\n\n\t// To calculate the horizontal position, we insert a test range and see if\n\t// this test range has the same horizontal position. This method proves to\n\t// be better than a DOM-based calculation, because it ignores empty text\n\t// nodes and a trailing line break element. In other words, we need to check\n\t// visual positioning, not DOM positioning.\n\tconst x = isReverseDir ? containerRect.left + 1 : containerRect.right - 1;\n\tconst y = isReverse\n\t\t? containerRect.top + buffer\n\t\t: containerRect.bottom - buffer;\n\tconst testRange = hiddenCaretRangeFromPoint(\n\t\townerDocument,\n\t\tx,\n\t\ty,\n\t\tcontainer\n\t);\n\n\tif ( ! testRange ) {\n\t\treturn false;\n\t}\n\n\tconst side = isReverseDir ? 'left' : 'right';\n\tconst testRect = getRectangleFromRange( testRange );\n\n\t// Allow the position to be 1px off.\n\treturn Math.abs( testRect[ side ] - rangeRect[ side ] ) <= 1;\n}\n\n/**\n * Check whether the selection is horizontally at the edge of the container.\n *\n * @param {Element} container Focusable element.\n * @param {boolean} isReverse Set to true to check left, false for right.\n *\n * @return {boolean} True if at the horizontal edge, false if not.\n */\nexport function isHorizontalEdge( container, isReverse ) {\n\treturn isEdge( container, isReverse );\n}\n\n/**\n * Check whether the selection is vertically at the edge of the container.\n *\n * @param {Element} container Focusable element.\n * @param {boolean} isReverse Set to true to check top, false for bottom.\n *\n * @return {boolean} True if at the vertical edge, false if not.\n */\nexport function isVerticalEdge( container, isReverse ) {\n\treturn isEdge( container, isReverse, true );\n}\n\n/**\n * Get the rectangle of a given Range.\n *\n * @param {Range} range The range.\n *\n * @return {DOMRect} The rectangle.\n */\nexport function getRectangleFromRange( range ) {\n\t// For uncollapsed ranges, get the rectangle that bounds the contents of the\n\t// range; this a rectangle enclosing the union of the bounding rectangles\n\t// for all the elements in the range.\n\tif ( ! range.collapsed ) {\n\t\treturn range.getBoundingClientRect();\n\t}\n\n\tconst { startContainer } = range;\n\tconst { ownerDocument } = startContainer;\n\n\t// Correct invalid \"BR\" ranges. The cannot contain any children.\n\tif ( startContainer.nodeName === 'BR' ) {\n\t\tconst { parentNode } = startContainer;\n\t\tconst index = Array.from( parentNode.childNodes ).indexOf(\n\t\t\tstartContainer\n\t\t);\n\n\t\trange = ownerDocument.createRange();\n\t\trange.setStart( parentNode, index );\n\t\trange.setEnd( parentNode, index );\n\t}\n\n\tlet rect = range.getClientRects()[ 0 ];\n\n\t// If the collapsed range starts (and therefore ends) at an element node,\n\t// `getClientRects` can be empty in some browsers. This can be resolved\n\t// by adding a temporary text node with zero-width space to the range.\n\t//\n\t// See: https://stackoverflow.com/a/6847328/995445\n\tif ( ! rect ) {\n\t\tconst padNode = ownerDocument.createTextNode( '\\u200b' );\n\t\t// Do not modify the live range.\n\t\trange = range.cloneRange();\n\t\trange.insertNode( padNode );\n\t\trect = range.getClientRects()[ 0 ];\n\t\tpadNode.parentNode.removeChild( padNode );\n\t}\n\n\treturn rect;\n}\n\n/**\n * Get the rectangle for the selection in a container.\n *\n * @param {Window} win The window of the selection.\n *\n * @return {?DOMRect} The rectangle.\n */\nexport function computeCaretRect( win ) {\n\tconst selection = win.getSelection();\n\tconst range = selection.rangeCount ? selection.getRangeAt( 0 ) : null;\n\n\tif ( ! range ) {\n\t\treturn;\n\t}\n\n\treturn getRectangleFromRange( range );\n}\n\n/**\n * Places the caret at start or end of a given element.\n *\n * @param {Element} container Focusable element.\n * @param {boolean} isReverse True for end, false for start.\n */\nexport function placeCaretAtHorizontalEdge( container, isReverse ) {\n\tif ( ! container ) {\n\t\treturn;\n\t}\n\n\tif ( includes( [ 'INPUT', 'TEXTAREA' ], container.tagName ) ) {\n\t\tcontainer.focus();\n\t\tif ( isReverse ) {\n\t\t\tcontainer.selectionStart = container.value.length;\n\t\t\tcontainer.selectionEnd = container.value.length;\n\t\t} else {\n\t\t\tcontainer.selectionStart = 0;\n\t\t\tcontainer.selectionEnd = 0;\n\t\t}\n\t\treturn;\n\t}\n\n\tcontainer.focus();\n\n\tif ( ! container.isContentEditable ) {\n\t\treturn;\n\t}\n\n\t// Select on extent child of the container, not the container itself. This\n\t// avoids the selection always being `endOffset` of 1 when placed at end,\n\t// where `startContainer`, `endContainer` would always be container itself.\n\tconst rangeTarget = container[ isReverse ? 'lastChild' : 'firstChild' ];\n\n\t// If no range target, it implies that the container is empty. Focusing is\n\t// sufficient for caret to be placed correctly.\n\tif ( ! rangeTarget ) {\n\t\treturn;\n\t}\n\n\tconst { ownerDocument } = container;\n\tconst { defaultView } = ownerDocument;\n\tconst selection = defaultView.getSelection();\n\tconst range = ownerDocument.createRange();\n\n\trange.selectNodeContents( rangeTarget );\n\trange.collapse( ! isReverse );\n\n\tselection.removeAllRanges();\n\tselection.addRange( range );\n}\n\n/**\n * Polyfill.\n * Get a collapsed range for a given point.\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/caretRangeFromPoint\n *\n * @param {Document} doc  The document of the range.\n * @param {number}   x    Horizontal position within the current viewport.\n * @param {number}   y    Vertical position within the current viewport.\n *\n * @return {?Range} The best range for the given point.\n */\nfunction caretRangeFromPoint( doc, x, y ) {\n\tif ( doc.caretRangeFromPoint ) {\n\t\treturn doc.caretRangeFromPoint( x, y );\n\t}\n\n\tif ( ! doc.caretPositionFromPoint ) {\n\t\treturn null;\n\t}\n\n\tconst point = doc.caretPositionFromPoint( x, y );\n\n\t// If x or y are negative, outside viewport, or there is no text entry node.\n\t// https://developer.mozilla.org/en-US/docs/Web/API/Document/caretRangeFromPoint\n\tif ( ! point ) {\n\t\treturn null;\n\t}\n\n\tconst range = doc.createRange();\n\n\trange.setStart( point.offsetNode, point.offset );\n\trange.collapse( true );\n\n\treturn range;\n}\n\n/**\n * Get a collapsed range for a given point.\n * Gives the container a temporary high z-index (above any UI).\n * This is preferred over getting the UI nodes and set styles there.\n *\n * @param {Document} doc       The document of the range.\n * @param {number}    x         Horizontal position within the current viewport.\n * @param {number}    y         Vertical position within the current viewport.\n * @param {Element}  container Container in which the range is expected to be found.\n *\n * @return {?Range} The best range for the given point.\n */\nfunction hiddenCaretRangeFromPoint( doc, x, y, container ) {\n\tconst originalZIndex = container.style.zIndex;\n\tconst originalPosition = container.style.position;\n\n\t// A z-index only works if the element position is not static.\n\tcontainer.style.zIndex = '10000';\n\tcontainer.style.position = 'relative';\n\n\tconst range = caretRangeFromPoint( doc, x, y );\n\n\tcontainer.style.zIndex = originalZIndex;\n\tcontainer.style.position = originalPosition;\n\n\treturn range;\n}\n\n/**\n * Places the caret at the top or bottom of a given element.\n *\n * @param {Element} container           Focusable element.\n * @param {boolean} isReverse           True for bottom, false for top.\n * @param {DOMRect} [rect]              The rectangle to position the caret with.\n * @param {boolean} [mayUseScroll=true] True to allow scrolling, false to disallow.\n */\nexport function placeCaretAtVerticalEdge(\n\tcontainer,\n\tisReverse,\n\trect,\n\tmayUseScroll = true\n) {\n\tif ( ! container ) {\n\t\treturn;\n\t}\n\n\tif ( ! rect || ! container.isContentEditable ) {\n\t\tplaceCaretAtHorizontalEdge( container, isReverse );\n\t\treturn;\n\t}\n\n\t// Offset by a buffer half the height of the caret rect. This is needed\n\t// because caretRangeFromPoint may default to the end of the selection if\n\t// offset is too close to the edge. It's unclear how to precisely calculate\n\t// this threshold; it may be the padded area of some combination of line\n\t// height, caret height, and font size. The buffer offset is effectively\n\t// equivalent to a point at half the height of a line of text.\n\tconst buffer = rect.height / 2;\n\tconst editableRect = container.getBoundingClientRect();\n\tconst x = rect.left;\n\tconst y = isReverse\n\t\t? editableRect.bottom - buffer\n\t\t: editableRect.top + buffer;\n\n\tconst { ownerDocument } = container;\n\tconst { defaultView } = ownerDocument;\n\tconst range = hiddenCaretRangeFromPoint( ownerDocument, x, y, container );\n\n\tif ( ! range || ! container.contains( range.startContainer ) ) {\n\t\tif (\n\t\t\tmayUseScroll &&\n\t\t\t( ! range ||\n\t\t\t\t! range.startContainer ||\n\t\t\t\t! range.startContainer.contains( container ) )\n\t\t) {\n\t\t\t// Might be out of view.\n\t\t\t// Easier than attempting to calculate manually.\n\t\t\tcontainer.scrollIntoView( isReverse );\n\t\t\tplaceCaretAtVerticalEdge( container, isReverse, rect, false );\n\t\t\treturn;\n\t\t}\n\n\t\tplaceCaretAtHorizontalEdge( container, isReverse );\n\t\treturn;\n\t}\n\n\tconst selection = defaultView.getSelection();\n\tselection.removeAllRanges();\n\tselection.addRange( range );\n\tcontainer.focus();\n\t// Editable was already focussed, it goes back to old range...\n\t// This fixes it.\n\tselection.removeAllRanges();\n\tselection.addRange( range );\n}\n\n/**\n * Check whether the given element is a text field, where text field is defined\n * by the ability to select within the input, or that it is contenteditable.\n *\n * See: https://html.spec.whatwg.org/#textFieldSelection\n *\n * @param {HTMLElement} element The HTML element.\n *\n * @return {boolean} True if the element is an text field, false if not.\n */\nexport function isTextField( element ) {\n\tconst { nodeName, contentEditable } = element;\n\tconst nonTextInputs = [\n\t\t'button',\n\t\t'checkbox',\n\t\t'hidden',\n\t\t'file',\n\t\t'radio',\n\t\t'image',\n\t\t'range',\n\t\t'reset',\n\t\t'submit',\n\t\t'number',\n\t];\n\treturn (\n\t\t( nodeName === 'INPUT' && ! nonTextInputs.includes( element.type ) ) ||\n\t\tnodeName === 'TEXTAREA' ||\n\t\tcontentEditable === 'true'\n\t);\n}\n\n/**\n * Check whether the given element is an input field of type number\n * and has a valueAsNumber\n *\n * @param {HTMLElement} element The HTML element.\n *\n * @return {boolean} True if the element is input and holds a number.\n */\nexport function isNumberInput( element ) {\n\tconst { nodeName, type, valueAsNumber } = element;\n\n\treturn nodeName === 'INPUT' && type === 'number' && !! valueAsNumber;\n}\n\n/**\n * Check whether the current document has selected text. This applies to ranges\n * of text in the document, and not selection inside <input> and <textarea>\n * elements.\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/Window/getSelection#Related_objects.\n *\n * @param {Document} doc The document to check.\n *\n * @return {boolean} True if there is selection, false if not.\n */\nexport function documentHasTextSelection( doc ) {\n\tconst selection = doc.defaultView.getSelection();\n\tconst range = selection.rangeCount ? selection.getRangeAt( 0 ) : null;\n\treturn range && ! range.collapsed;\n}\n\n/**\n * Check whether the given element, assumed an input field or textarea,\n * contains a (uncollapsed) selection of text.\n *\n * Note: this is perhaps an abuse of the term \"selection\", since these elements\n * manage selection differently and aren't covered by Selection#collapsed.\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/Window/getSelection#Related_objects.\n *\n * @param {HTMLElement} element The HTML element.\n *\n * @return {boolean} Whether the input/textareaa element has some \"selection\".\n */\nfunction inputFieldHasUncollapsedSelection( element ) {\n\tif ( ! isTextField( element ) && ! isNumberInput( element ) ) {\n\t\treturn false;\n\t}\n\ttry {\n\t\tconst { selectionStart, selectionEnd } = element;\n\n\t\treturn selectionStart !== null && selectionStart !== selectionEnd;\n\t} catch ( error ) {\n\t\t// Safari throws an exception when trying to get `selectionStart`\n\t\t// on non-text <input> elements (which, understandably, don't\n\t\t// have the text selection API). We catch this via a try/catch\n\t\t// block, as opposed to a more explicit check of the element's\n\t\t// input types, because of Safari's non-standard behavior. This\n\t\t// also means we don't have to worry about the list of input\n\t\t// types that support `selectionStart` changing as the HTML spec\n\t\t// evolves over time.\n\t\treturn false;\n\t}\n}\n\n/**\n * Check whether the current document has any sort of selection. This includes\n * ranges of text across elements and any selection inside <input> and\n * <textarea> elements.\n *\n * @param {Document} doc The document to check.\n *\n * @return {boolean} Whether there is any sort of \"selection\" in the document.\n */\nexport function documentHasUncollapsedSelection( doc ) {\n\treturn (\n\t\tdocumentHasTextSelection( doc ) ||\n\t\tinputFieldHasUncollapsedSelection( doc.activeElement )\n\t);\n}\n\n/**\n * Check whether the current document has a selection. This checks for both\n * focus in an input field and general text selection.\n *\n * @param {Document} doc The document to check.\n *\n * @return {boolean} True if there is selection, false if not.\n */\nexport function documentHasSelection( doc ) {\n\treturn (\n\t\tisTextField( doc.activeElement ) ||\n\t\tisNumberInput( doc.activeElement ) ||\n\t\tdocumentHasTextSelection( doc )\n\t);\n}\n\n/**\n * Check whether the contents of the element have been entirely selected.\n * Returns true if there is no possibility of selection.\n *\n * @param {Element} element The element to check.\n *\n * @return {boolean} True if entirely selected, false if not.\n */\nexport function isEntirelySelected( element ) {\n\tif ( includes( [ 'INPUT', 'TEXTAREA' ], element.nodeName ) ) {\n\t\treturn (\n\t\t\telement.selectionStart === 0 &&\n\t\t\telement.value.length === element.selectionEnd\n\t\t);\n\t}\n\n\tif ( ! element.isContentEditable ) {\n\t\treturn true;\n\t}\n\n\tconst { ownerDocument } = element;\n\tconst { defaultView } = ownerDocument;\n\tconst selection = defaultView.getSelection();\n\tconst range = selection.rangeCount ? selection.getRangeAt( 0 ) : null;\n\n\tif ( ! range ) {\n\t\treturn true;\n\t}\n\n\tconst { startContainer, endContainer, startOffset, endOffset } = range;\n\n\tif (\n\t\tstartContainer === element &&\n\t\tendContainer === element &&\n\t\tstartOffset === 0 &&\n\t\tendOffset === element.childNodes.length\n\t) {\n\t\treturn true;\n\t}\n\n\tconst lastChild = element.lastChild;\n\tconst lastChildContentLength =\n\t\tlastChild.nodeType === lastChild.TEXT_NODE\n\t\t\t? lastChild.data.length\n\t\t\t: lastChild.childNodes.length;\n\n\treturn (\n\t\tstartContainer === element.firstChild &&\n\t\tendContainer === element.lastChild &&\n\t\tstartOffset === 0 &&\n\t\tendOffset === lastChildContentLength\n\t);\n}\n\n/**\n * Given a DOM node, finds the closest scrollable container node.\n *\n * @param {Element} node Node from which to start.\n *\n * @return {?Element} Scrollable container node, if found.\n */\nexport function getScrollContainer( node ) {\n\tif ( ! node ) {\n\t\treturn;\n\t}\n\n\t// Scrollable if scrollable height exceeds displayed...\n\tif ( node.scrollHeight > node.clientHeight ) {\n\t\t// ...except when overflow is defined to be hidden or visible\n\t\tconst { overflowY } = getComputedStyle( node );\n\t\tif ( /(auto|scroll)/.test( overflowY ) ) {\n\t\t\treturn node;\n\t\t}\n\t}\n\n\t// Continue traversing\n\treturn getScrollContainer( node.parentNode );\n}\n\n/**\n * Returns the closest positioned element, or null under any of the conditions\n * of the offsetParent specification. Unlike offsetParent, this function is not\n * limited to HTMLElement and accepts any Node (e.g. Node.TEXT_NODE).\n *\n * @see https://drafts.csswg.org/cssom-view/#dom-htmlelement-offsetparent\n *\n * @param {Node} node Node from which to find offset parent.\n *\n * @return {?Node} Offset parent.\n */\nexport function getOffsetParent( node ) {\n\t// Cannot retrieve computed style or offset parent only anything other than\n\t// an element node, so find the closest element node.\n\tlet closestElement;\n\twhile ( ( closestElement = node.parentNode ) ) {\n\t\tif ( closestElement.nodeType === closestElement.ELEMENT_NODE ) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif ( ! closestElement ) {\n\t\treturn null;\n\t}\n\n\t// If the closest element is already positioned, return it, as offsetParent\n\t// does not otherwise consider the node itself.\n\tif ( getComputedStyle( closestElement ).position !== 'static' ) {\n\t\treturn closestElement;\n\t}\n\n\treturn closestElement.offsetParent;\n}\n\n/**\n * Given two DOM nodes, replaces the former with the latter in the DOM.\n *\n * @param {Element} processedNode Node to be removed.\n * @param {Element} newNode       Node to be inserted in its place.\n * @return {void}\n */\nexport function replace( processedNode, newNode ) {\n\tinsertAfter( newNode, processedNode.parentNode );\n\tremove( processedNode );\n}\n\n/**\n * Given a DOM node, removes it from the DOM.\n *\n * @param {Element} node Node to be removed.\n * @return {void}\n */\nexport function remove( node ) {\n\tnode.parentNode.removeChild( node );\n}\n\n/**\n * Given two DOM nodes, inserts the former in the DOM as the next sibling of\n * the latter.\n *\n * @param {Element} newNode       Node to be inserted.\n * @param {Element} referenceNode Node after which to perform the insertion.\n * @return {void}\n */\nexport function insertAfter( newNode, referenceNode ) {\n\treferenceNode.parentNode.insertBefore( newNode, referenceNode.nextSibling );\n}\n\n/**\n * Unwrap the given node. This means any child nodes are moved to the parent.\n *\n * @param {Node} node The node to unwrap.\n *\n * @return {void}\n */\nexport function unwrap( node ) {\n\tconst parent = node.parentNode;\n\n\twhile ( node.firstChild ) {\n\t\tparent.insertBefore( node.firstChild, node );\n\t}\n\n\tparent.removeChild( node );\n}\n\n/**\n * Replaces the given node with a new node with the given tag name.\n *\n * @param {Element}  node    The node to replace\n * @param {string}   tagName The new tag name.\n *\n * @return {Element} The new node.\n */\nexport function replaceTag( node, tagName ) {\n\tconst newNode = node.ownerDocument.createElement( tagName );\n\n\twhile ( node.firstChild ) {\n\t\tnewNode.appendChild( node.firstChild );\n\t}\n\n\tnode.parentNode.replaceChild( newNode, node );\n\n\treturn newNode;\n}\n\n/**\n * Wraps the given node with a new node with the given tag name.\n *\n * @param {Element} newNode       The node to insert.\n * @param {Element} referenceNode The node to wrap.\n */\nexport function wrap( newNode, referenceNode ) {\n\treferenceNode.parentNode.insertBefore( newNode, referenceNode );\n\tnewNode.appendChild( referenceNode );\n}\n\n/**\n * Removes any HTML tags from the provided string.\n *\n * @param {string} html The string containing html.\n *\n * @return {string} The text content with any html removed.\n */\nexport function __unstableStripHTML( html ) {\n\tconst document = new window.DOMParser().parseFromString(\n\t\thtml,\n\t\t'text/html'\n\t);\n\treturn document.body.textContent || '';\n}\n\n/**\n * Given a schema, unwraps or removes nodes, attributes and classes on a node\n * list.\n *\n * @param {NodeList} nodeList The nodeList to filter.\n * @param {Document} doc      The document of the nodeList.\n * @param {Object}   schema   An array of functions that can mutate with the provided node.\n * @param {Object}   inline   Whether to clean for inline mode.\n */\nfunction cleanNodeList( nodeList, doc, schema, inline ) {\n\tArray.from( nodeList ).forEach( ( node ) => {\n\t\tconst tag = node.nodeName.toLowerCase();\n\n\t\t// It's a valid child, if the tag exists in the schema without an isMatch\n\t\t// function, or with an isMatch function that matches the node.\n\t\tif (\n\t\t\tschema.hasOwnProperty( tag ) &&\n\t\t\t( ! schema[ tag ].isMatch || schema[ tag ].isMatch( node ) )\n\t\t) {\n\t\t\tif ( node.nodeType === node.ELEMENT_NODE ) {\n\t\t\t\tconst {\n\t\t\t\t\tattributes = [],\n\t\t\t\t\tclasses = [],\n\t\t\t\t\tchildren,\n\t\t\t\t\trequire = [],\n\t\t\t\t\tallowEmpty,\n\t\t\t\t} = schema[ tag ];\n\n\t\t\t\t// If the node is empty and it's supposed to have children,\n\t\t\t\t// remove the node.\n\t\t\t\tif ( children && ! allowEmpty && isEmpty( node ) ) {\n\t\t\t\t\tremove( node );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( node.hasAttributes() ) {\n\t\t\t\t\t// Strip invalid attributes.\n\t\t\t\t\tArray.from( node.attributes ).forEach( ( { name } ) => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tname !== 'class' &&\n\t\t\t\t\t\t\t! includes( attributes, name )\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tnode.removeAttribute( name );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Strip invalid classes.\n\t\t\t\t\t// In jsdom-jscore, 'node.classList' can be undefined.\n\t\t\t\t\t// TODO: Explore patching this in jsdom-jscore.\n\t\t\t\t\tif ( node.classList && node.classList.length ) {\n\t\t\t\t\t\tconst mattchers = classes.map( ( item ) => {\n\t\t\t\t\t\t\tif ( typeof item === 'string' ) {\n\t\t\t\t\t\t\t\treturn ( className ) => className === item;\n\t\t\t\t\t\t\t} else if ( item instanceof RegExp ) {\n\t\t\t\t\t\t\t\treturn ( className ) => item.test( className );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn noop;\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tArray.from( node.classList ).forEach( ( name ) => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t! mattchers.some( ( isMatch ) =>\n\t\t\t\t\t\t\t\t\tisMatch( name )\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tnode.classList.remove( name );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tif ( ! node.classList.length ) {\n\t\t\t\t\t\t\tnode.removeAttribute( 'class' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( node.hasChildNodes() ) {\n\t\t\t\t\t// Do not filter any content.\n\t\t\t\t\tif ( children === '*' ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Continue if the node is supposed to have children.\n\t\t\t\t\tif ( children ) {\n\t\t\t\t\t\t// If a parent requires certain children, but it does\n\t\t\t\t\t\t// not have them, drop the parent and continue.\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\trequire.length &&\n\t\t\t\t\t\t\t! node.querySelector( require.join( ',' ) )\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tcleanNodeList(\n\t\t\t\t\t\t\t\tnode.childNodes,\n\t\t\t\t\t\t\t\tdoc,\n\t\t\t\t\t\t\t\tschema,\n\t\t\t\t\t\t\t\tinline\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tunwrap( node );\n\t\t\t\t\t\t\t// If the node is at the top, phrasing content, and\n\t\t\t\t\t\t\t// contains children that are block content, unwrap\n\t\t\t\t\t\t\t// the node because it is invalid.\n\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\tnode.parentNode.nodeName === 'BODY' &&\n\t\t\t\t\t\t\tisPhrasingContent( node )\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tcleanNodeList(\n\t\t\t\t\t\t\t\tnode.childNodes,\n\t\t\t\t\t\t\t\tdoc,\n\t\t\t\t\t\t\t\tschema,\n\t\t\t\t\t\t\t\tinline\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tArray.from( node.childNodes ).some(\n\t\t\t\t\t\t\t\t\t( child ) => ! isPhrasingContent( child )\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tunwrap( node );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcleanNodeList(\n\t\t\t\t\t\t\t\tnode.childNodes,\n\t\t\t\t\t\t\t\tdoc,\n\t\t\t\t\t\t\t\tchildren,\n\t\t\t\t\t\t\t\tinline\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Remove children if the node is not supposed to have any.\n\t\t\t\t\t} else {\n\t\t\t\t\t\twhile ( node.firstChild ) {\n\t\t\t\t\t\t\tremove( node.firstChild );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Invalid child. Continue with schema at the same place and unwrap.\n\t\t} else {\n\t\t\tcleanNodeList( node.childNodes, doc, schema, inline );\n\n\t\t\t// For inline mode, insert a line break when unwrapping nodes that\n\t\t\t// are not phrasing content.\n\t\t\tif (\n\t\t\t\tinline &&\n\t\t\t\t! isPhrasingContent( node ) &&\n\t\t\t\tnode.nextElementSibling\n\t\t\t) {\n\t\t\t\tinsertAfter( doc.createElement( 'br' ), node );\n\t\t\t}\n\n\t\t\tunwrap( node );\n\t\t}\n\t} );\n}\n\n/**\n * Recursively checks if an element is empty. An element is not empty if it\n * contains text or contains elements with attributes such as images.\n *\n * @param {Element} element The element to check.\n *\n * @return {boolean} Wether or not the element is empty.\n */\nexport function isEmpty( element ) {\n\tif ( ! element.hasChildNodes() ) {\n\t\treturn true;\n\t}\n\n\treturn Array.from( element.childNodes ).every( ( node ) => {\n\t\tif ( node.nodeType === node.TEXT_NODE ) {\n\t\t\treturn ! node.nodeValue.trim();\n\t\t}\n\n\t\tif ( node.nodeType === node.ELEMENT_NODE ) {\n\t\t\tif ( node.nodeName === 'BR' ) {\n\t\t\t\treturn true;\n\t\t\t} else if ( node.hasAttributes() ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn isEmpty( node );\n\t\t}\n\n\t\treturn true;\n\t} );\n}\n\n/**\n * Given a schema, unwraps or removes nodes, attributes and classes on HTML.\n *\n * @param {string} HTML   The HTML to clean up.\n * @param {Object} schema Schema for the HTML.\n * @param {Object} inline Whether to clean for inline mode.\n *\n * @return {string} The cleaned up HTML.\n */\nexport function removeInvalidHTML( HTML, schema, inline ) {\n\tconst doc = document.implementation.createHTMLDocument( '' );\n\n\tdoc.body.innerHTML = HTML;\n\n\tcleanNodeList( doc.body.childNodes, doc, schema, inline );\n\n\treturn doc.body.innerHTML;\n}\n","/**\n * References:\n *\n * Focusable:\n *  - https://www.w3.org/TR/html5/editing.html#focus-management\n *\n * Sequential focus navigation:\n *  - https://www.w3.org/TR/html5/editing.html#sequential-focus-navigation-and-the-tabindex-attribute\n *\n * Disabled elements:\n *  - https://www.w3.org/TR/html5/disabled-elements.html#disabled-elements\n *\n * getClientRects algorithm (requiring layout box):\n *  - https://www.w3.org/TR/cssom-view-1/#extension-to-the-element-interface\n *\n * AREA elements associated with an IMG:\n *  - https://w3c.github.io/html/editing.html#data-model\n */\n\nconst SELECTOR = [\n\t'[tabindex]',\n\t'a[href]',\n\t'button:not([disabled])',\n\t'input:not([type=\"hidden\"]):not([disabled])',\n\t'select:not([disabled])',\n\t'textarea:not([disabled])',\n\t'iframe',\n\t'object',\n\t'embed',\n\t'area[href]',\n\t'[contenteditable]:not([contenteditable=false])',\n].join( ',' );\n\n/**\n * Returns true if the specified element is visible (i.e. neither display: none\n * nor visibility: hidden).\n *\n * @param {Element} element DOM element to test.\n *\n * @return {boolean} Whether element is visible.\n */\nfunction isVisible( element ) {\n\treturn (\n\t\telement.offsetWidth > 0 ||\n\t\telement.offsetHeight > 0 ||\n\t\telement.getClientRects().length > 0\n\t);\n}\n\n/**\n * Returns true if the specified element should be skipped from focusable elements.\n * For now it rather specific for `iframes` and  if tabindex attribute is set to -1.\n *\n * @param {Element} element DOM element to test.\n *\n * @return {boolean} Whether element should be skipped from focusable elements.\n */\nfunction skipFocus( element ) {\n\treturn (\n\t\telement.nodeName.toLowerCase() === 'iframe' &&\n\t\telement.getAttribute( 'tabindex' ) === '-1'\n\t);\n}\n\n/**\n * Returns true if the specified area element is a valid focusable element, or\n * false otherwise. Area is only focusable if within a map where a named map\n * referenced by an image somewhere in the document.\n *\n * @param {Element} element DOM area element to test.\n *\n * @return {boolean} Whether area element is valid for focus.\n */\nfunction isValidFocusableArea( element ) {\n\tconst map = element.closest( 'map[name]' );\n\tif ( ! map ) {\n\t\treturn false;\n\t}\n\n\tconst img = element.ownerDocument.querySelector(\n\t\t'img[usemap=\"#' + map.name + '\"]'\n\t);\n\treturn !! img && isVisible( img );\n}\n\n/**\n * Returns all focusable elements within a given context.\n *\n * @param {Element} context Element in which to search.\n *\n * @return {Element[]} Focusable elements.\n */\nexport function find( context ) {\n\tconst elements = context.querySelectorAll( SELECTOR );\n\n\treturn Array.from( elements ).filter( ( element ) => {\n\t\tif ( ! isVisible( element ) || skipFocus( element ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst { nodeName } = element;\n\t\tif ( 'AREA' === nodeName ) {\n\t\t\treturn isValidFocusableArea( element );\n\t\t}\n\n\t\treturn true;\n\t} );\n}\n","/**\n * Internal dependencies\n */\nimport * as focusable from './focusable';\nimport * as tabbable from './tabbable';\n\n/**\n * Object grouping `focusable` and `tabbable` utils\n * under the keys with the same name.\n */\nexport const focus = { focusable, tabbable };\n\nexport * from './dom';\nexport * from './phrasing-content';\n","/**\n * External dependencies\n */\nimport { omit, without } from 'lodash';\n\n/**\n * All phrasing content elements.\n *\n * @see https://www.w3.org/TR/2011/WD-html5-20110525/content-models.html#phrasing-content-0\n */\n\n/**\n * All text-level semantic elements.\n *\n * @see https://html.spec.whatwg.org/multipage/text-level-semantics.html\n */\nconst textContentSchema = {\n\tstrong: {},\n\tem: {},\n\ts: {},\n\tdel: {},\n\tins: {},\n\ta: { attributes: [ 'href', 'target', 'rel' ] },\n\tcode: {},\n\tabbr: { attributes: [ 'title' ] },\n\tsub: {},\n\tsup: {},\n\tbr: {},\n\tsmall: {},\n\t// To do: fix blockquote.\n\t// cite: {},\n\tq: { attributes: [ 'cite' ] },\n\tdfn: { attributes: [ 'title' ] },\n\tdata: { attributes: [ 'value' ] },\n\ttime: { attributes: [ 'datetime' ] },\n\tvar: {},\n\tsamp: {},\n\tkbd: {},\n\ti: {},\n\tb: {},\n\tu: {},\n\tmark: {},\n\truby: {},\n\trt: {},\n\trp: {},\n\tbdi: { attributes: [ 'dir' ] },\n\tbdo: { attributes: [ 'dir' ] },\n\twbr: {},\n\t'#text': {},\n};\n\n// Recursion is needed.\n// Possible: strong > em > strong.\n// Impossible: strong > strong.\nwithout( Object.keys( textContentSchema ), '#text', 'br' ).forEach( ( tag ) => {\n\ttextContentSchema[ tag ].children = omit( textContentSchema, tag );\n} );\n\n/**\n * Embedded content elements.\n *\n * @see https://www.w3.org/TR/2011/WD-html5-20110525/content-models.html#embedded-content-0\n */\nconst embeddedContentSchema = {\n\taudio: {\n\t\tattributes: [\n\t\t\t'src',\n\t\t\t'preload',\n\t\t\t'autoplay',\n\t\t\t'mediagroup',\n\t\t\t'loop',\n\t\t\t'muted',\n\t\t],\n\t},\n\tcanvas: { attributes: [ 'width', 'height' ] },\n\tembed: { attributes: [ 'src', 'type', 'width', 'height' ] },\n\timg: {\n\t\tattributes: [\n\t\t\t'alt',\n\t\t\t'src',\n\t\t\t'srcset',\n\t\t\t'usemap',\n\t\t\t'ismap',\n\t\t\t'width',\n\t\t\t'height',\n\t\t],\n\t},\n\tobject: {\n\t\tattributes: [\n\t\t\t'data',\n\t\t\t'type',\n\t\t\t'name',\n\t\t\t'usemap',\n\t\t\t'form',\n\t\t\t'width',\n\t\t\t'height',\n\t\t],\n\t},\n\tvideo: {\n\t\tattributes: [\n\t\t\t'src',\n\t\t\t'poster',\n\t\t\t'preload',\n\t\t\t'autoplay',\n\t\t\t'mediagroup',\n\t\t\t'loop',\n\t\t\t'muted',\n\t\t\t'controls',\n\t\t\t'width',\n\t\t\t'height',\n\t\t],\n\t},\n};\n\n/**\n * Phrasing content elements.\n *\n * @see https://www.w3.org/TR/2011/WD-html5-20110525/content-models.html#phrasing-content-0\n */\nconst phrasingContentSchema = {\n\t...textContentSchema,\n\t...embeddedContentSchema,\n};\n\n/**\n * Get schema of possible paths for phrasing content.\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Content_categories#Phrasing_content\n *\n * @param {string} context Set to \"paste\" to exclude invisible elements and\n *                         sensitive data.\n *\n * @return {Object} Schema.\n */\nexport function getPhrasingContentSchema( context ) {\n\tif ( context !== 'paste' ) {\n\t\treturn phrasingContentSchema;\n\t}\n\n\treturn omit(\n\t\t{\n\t\t\t...phrasingContentSchema,\n\t\t\t// We shouldn't paste potentially sensitive information which is not\n\t\t\t// visible to the user when pasted, so strip the attributes.\n\t\t\tins: { children: phrasingContentSchema.ins.children },\n\t\t\tdel: { children: phrasingContentSchema.del.children },\n\t\t},\n\t\t[\n\t\t\t'u', // Used to mark misspelling. Shouldn't be pasted.\n\t\t\t'abbr', // Invisible.\n\t\t\t'data', // Invisible.\n\t\t\t'time', // Invisible.\n\t\t\t'wbr', // Invisible.\n\t\t\t'bdi', // Invisible.\n\t\t\t'bdo', // Invisible.\n\t\t]\n\t);\n}\n\n/**\n * Find out whether or not the given node is phrasing content.\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Content_categories#Phrasing_content\n *\n * @param {Element} node The node to test.\n *\n * @return {boolean} True if phrasing content, false if not.\n */\nexport function isPhrasingContent( node ) {\n\tconst tag = node.nodeName.toLowerCase();\n\treturn getPhrasingContentSchema().hasOwnProperty( tag ) || tag === 'span';\n}\n\nexport function isTextContent( node ) {\n\tconst tag = node.nodeName.toLowerCase();\n\treturn textContentSchema.hasOwnProperty( tag ) || tag === 'span';\n}\n","/**\n * External dependencies\n */\nimport { without, first, last } from 'lodash';\n\n/**\n * Internal dependencies\n */\nimport { find as findFocusable } from './focusable';\n\n/**\n * Returns the tab index of the given element. In contrast with the tabIndex\n * property, this normalizes the default (0) to avoid browser inconsistencies,\n * operating under the assumption that this function is only ever called with a\n * focusable node.\n *\n * @see https://bugzilla.mozilla.org/show_bug.cgi?id=1190261\n *\n * @param {Element} element Element from which to retrieve.\n *\n * @return {?number} Tab index of element (default 0).\n */\nfunction getTabIndex( element ) {\n\tconst tabIndex = element.getAttribute( 'tabindex' );\n\treturn tabIndex === null ? 0 : parseInt( tabIndex, 10 );\n}\n\n/**\n * Returns true if the specified element is tabbable, or false otherwise.\n *\n * @param {Element} element Element to test.\n *\n * @return {boolean} Whether element is tabbable.\n */\nexport function isTabbableIndex( element ) {\n\treturn getTabIndex( element ) !== -1;\n}\n\n/**\n * Returns a stateful reducer function which constructs a filtered array of\n * tabbable elements, where at most one radio input is selected for a given\n * name, giving priority to checked input, falling back to the first\n * encountered.\n *\n * @return {Function} Radio group collapse reducer.\n */\nfunction createStatefulCollapseRadioGroup() {\n\tconst CHOSEN_RADIO_BY_NAME = {};\n\n\treturn function collapseRadioGroup( result, element ) {\n\t\tconst { nodeName, type, checked, name } = element;\n\n\t\t// For all non-radio tabbables, construct to array by concatenating.\n\t\tif ( nodeName !== 'INPUT' || type !== 'radio' || ! name ) {\n\t\t\treturn result.concat( element );\n\t\t}\n\n\t\tconst hasChosen = CHOSEN_RADIO_BY_NAME.hasOwnProperty( name );\n\n\t\t// Omit by skipping concatenation if the radio element is not chosen.\n\t\tconst isChosen = checked || ! hasChosen;\n\t\tif ( ! isChosen ) {\n\t\t\treturn result;\n\t\t}\n\n\t\t// At this point, if there had been a chosen element, the current\n\t\t// element is checked and should take priority. Retroactively remove\n\t\t// the element which had previously been considered the chosen one.\n\t\tif ( hasChosen ) {\n\t\t\tconst hadChosenElement = CHOSEN_RADIO_BY_NAME[ name ];\n\t\t\tresult = without( result, hadChosenElement );\n\t\t}\n\n\t\tCHOSEN_RADIO_BY_NAME[ name ] = element;\n\n\t\treturn result.concat( element );\n\t};\n}\n\n/**\n * An array map callback, returning an object with the element value and its\n * array index location as properties. This is used to emulate a proper stable\n * sort where equal tabIndex should be left in order of their occurrence in the\n * document.\n *\n * @param {Element} element Element.\n * @param {number}  index   Array index of element.\n *\n * @return {Object} Mapped object with element, index.\n */\nfunction mapElementToObjectTabbable( element, index ) {\n\treturn { element, index };\n}\n\n/**\n * An array map callback, returning an element of the given mapped object's\n * element value.\n *\n * @param {Object} object Mapped object with index.\n *\n * @return {Element} Mapped object element.\n */\nfunction mapObjectTabbableToElement( object ) {\n\treturn object.element;\n}\n\n/**\n * A sort comparator function used in comparing two objects of mapped elements.\n *\n * @see mapElementToObjectTabbable\n *\n * @param {Object} a First object to compare.\n * @param {Object} b Second object to compare.\n *\n * @return {number} Comparator result.\n */\nfunction compareObjectTabbables( a, b ) {\n\tconst aTabIndex = getTabIndex( a.element );\n\tconst bTabIndex = getTabIndex( b.element );\n\n\tif ( aTabIndex === bTabIndex ) {\n\t\treturn a.index - b.index;\n\t}\n\n\treturn aTabIndex - bTabIndex;\n}\n\n/**\n * Givin focusable elements, filters out tabbable element.\n *\n * @param {Array} focusables Focusable elements to filter.\n *\n * @return {Array} Tabbable elements.\n */\nfunction filterTabbable( focusables ) {\n\treturn focusables\n\t\t.filter( isTabbableIndex )\n\t\t.map( mapElementToObjectTabbable )\n\t\t.sort( compareObjectTabbables )\n\t\t.map( mapObjectTabbableToElement )\n\t\t.reduce( createStatefulCollapseRadioGroup(), [] );\n}\n\nexport function find( context ) {\n\treturn filterTabbable( findFocusable( context ) );\n}\n\n/**\n * Given a focusable element, find the preceding tabbable element.\n *\n * @param {Element} element The focusable element before which to look. Defaults\n *                          to the active element.\n */\nexport function findPrevious( element ) {\n\tconst focusables = findFocusable( element.ownerDocument.body );\n\tconst index = focusables.indexOf( element );\n\n\t// Remove all focusables after and including `element`.\n\tfocusables.length = index;\n\n\treturn last( filterTabbable( focusables ) );\n}\n\n/**\n * Given a focusable element, find the next tabbable element.\n *\n * @param {Element} element The focusable element after which to look. Defaults\n *                          to the active element.\n */\nexport function findNext( element ) {\n\tconst focusables = findFocusable( element.ownerDocument.body );\n\tconst index = focusables.indexOf( element );\n\n\t// Remove all focusables before and inside `element`.\n\tconst remaining = focusables\n\t\t.slice( index + 1 )\n\t\t.filter( ( node ) => ! element.contains( node ) );\n\n\treturn first( filterTabbable( remaining ) );\n}\n","(function() { module.exports = this[\"lodash\"]; }());"],"sourceRoot":""}